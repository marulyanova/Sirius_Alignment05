
  0%|          | 0/5424 [00:00<?, ?it/s]You're using a LlamaTokenizerFast tokenizer. Please note that with a fast tokenizer, using the `__call__` method is faster than using a method to encode the text followed by a call to the `pad` method to get a padded encoding.

  0%|          | 13/5424 [00:07<27:15,  3.31it/s]

  0%|          | 20/5424 [00:09<24:31,  3.67it/s]

  0%|          | 27/5424 [00:11<24:19,  3.70it/s]


  1%|          | 43/5424 [00:15<23:48,  3.77it/s]

  1%|          | 50/5424 [00:17<23:43,  3.78it/s]

  1%|          | 58/5424 [00:19<23:36,  3.79it/s]


  1%|▏         | 72/5424 [00:23<27:57,  3.19it/s]

  1%|▏         | 79/5424 [00:25<24:12,  3.68it/s]


  2%|▏         | 94/5424 [00:29<24:12,  3.67it/s]

  2%|▏         | 102/5424 [00:31<23:46,  3.73it/s]

  2%|▏         | 109/5424 [00:33<23:28,  3.77it/s]


  2%|▏         | 124/5424 [00:37<23:27,  3.77it/s]

  2%|▏         | 132/5424 [00:39<23:24,  3.77it/s]

  3%|▎         | 139/5424 [00:41<23:48,  3.70it/s]


  3%|▎         | 154/5424 [00:45<23:30,  3.74it/s]

  3%|▎         | 162/5424 [00:47<23:30,  3.73it/s]

  3%|▎         | 169/5424 [00:49<23:22,  3.75it/s]


  3%|▎         | 184/5424 [00:53<23:19,  3.74it/s]

  4%|▎         | 192/5424 [00:55<23:07,  3.77it/s]

  4%|▎         | 199/5424 [00:57<23:03,  3.78it/s]


  4%|▍         | 214/5424 [01:01<23:06,  3.76it/s]

  4%|▍         | 222/5424 [01:03<23:28,  3.69it/s]

  4%|▍         | 229/5424 [01:05<23:03,  3.75it/s]


  4%|▍         | 244/5424 [01:09<22:57,  3.76it/s]

  5%|▍         | 252/5424 [01:11<23:00,  3.75it/s]

  5%|▍         | 259/5424 [01:13<22:51,  3.77it/s]


  5%|▌         | 274/5424 [01:17<22:46,  3.77it/s]

  5%|▌         | 282/5424 [01:19<22:47,  3.76it/s]

  5%|▌         | 289/5424 [01:21<22:57,  3.73it/s]


  6%|▌         | 304/5424 [01:25<23:17,  3.66it/s]

  6%|▌         | 312/5424 [01:27<22:36,  3.77it/s]

  6%|▌         | 319/5424 [01:29<22:56,  3.71it/s]


  6%|▌         | 334/5424 [01:33<22:39,  3.74it/s]

  6%|▋         | 342/5424 [01:35<22:54,  3.70it/s]

  6%|▋         | 349/5424 [01:37<22:28,  3.76it/s]


  7%|▋         | 364/5424 [01:41<22:30,  3.75it/s]

  7%|▋         | 371/5424 [01:43<22:47,  3.69it/s]

  7%|▋         | 379/5424 [01:45<22:24,  3.75it/s]


  7%|▋         | 394/5424 [01:49<22:44,  3.69it/s]

  7%|▋         | 401/5424 [01:51<22:49,  3.67it/s]

  8%|▊         | 409/5424 [01:53<22:55,  3.65it/s]


  8%|▊         | 424/5424 [01:58<22:11,  3.76it/s]

  8%|▊         | 431/5424 [01:59<22:21,  3.72it/s]

  8%|▊         | 438/5424 [02:01<22:19,  3.72it/s]


  8%|▊         | 453/5424 [02:05<22:11,  3.73it/s]

  8%|▊         | 461/5424 [02:08<22:21,  3.70it/s]

  9%|▊         | 468/5424 [02:09<22:02,  3.75it/s]


  9%|▉         | 483/5424 [02:13<22:12,  3.71it/s]

  9%|▉         | 491/5424 [02:16<22:11,  3.71it/s]

  9%|▉         | 498/5424 [02:17<22:14,  3.69it/s]


  9%|▉         | 513/5424 [02:21<21:47,  3.76it/s]

 10%|▉         | 521/5424 [02:24<21:59,  3.72it/s]

 10%|▉         | 528/5424 [02:25<22:02,  3.70it/s]


 10%|█         | 543/5424 [02:29<21:39,  3.76it/s]

 10%|█         | 551/5424 [02:32<22:00,  3.69it/s]

 10%|█         | 558/5424 [02:33<21:49,  3.72it/s]


 11%|█         | 573/5424 [02:37<21:29,  3.76it/s]

 11%|█         | 581/5424 [02:40<21:30,  3.75it/s]

 11%|█         | 588/5424 [02:41<21:52,  3.69it/s]


 11%|█         | 603/5424 [02:45<21:21,  3.76it/s]

 11%|█▏        | 611/5424 [02:48<21:18,  3.76it/s]

 11%|█▏        | 618/5424 [02:49<21:11,  3.78it/s]


 12%|█▏        | 633/5424 [02:54<21:49,  3.66it/s]

 12%|█▏        | 640/5424 [02:55<21:47,  3.66it/s]

 12%|█▏        | 648/5424 [02:58<21:17,  3.74it/s]


 12%|█▏        | 663/5424 [03:02<21:19,  3.72it/s]

 12%|█▏        | 670/5424 [03:03<21:13,  3.73it/s]

 12%|█▎        | 678/5424 [03:06<20:56,  3.78it/s]


 13%|█▎        | 693/5424 [03:10<21:05,  3.74it/s]

 13%|█▎        | 700/5424 [03:12<21:15,  3.70it/s]

 13%|█▎        | 708/5424 [03:14<20:55,  3.76it/s]


 13%|█▎        | 723/5424 [03:18<20:49,  3.76it/s]

 13%|█▎        | 730/5424 [03:20<21:16,  3.68it/s]


 14%|█▎        | 745/5424 [03:24<20:56,  3.72it/s]

 14%|█▍        | 752/5424 [03:26<20:59,  3.71it/s]

 14%|█▍        | 760/5424 [03:28<20:36,  3.77it/s]


 14%|█▍        | 775/5424 [03:32<20:36,  3.76it/s]

 14%|█▍        | 782/5424 [03:34<20:33,  3.76it/s]

 15%|█▍        | 790/5424 [03:36<22:01,  3.51it/s]


 15%|█▍        | 805/5424 [03:40<20:40,  3.72it/s]

 15%|█▍        | 812/5424 [03:42<20:28,  3.75it/s]

 15%|█▌        | 820/5424 [03:44<20:21,  3.77it/s]


 15%|█▌        | 835/5424 [03:48<20:14,  3.78it/s]

 16%|█▌        | 842/5424 [03:50<20:26,  3.74it/s]

 16%|█▌        | 850/5424 [03:52<20:14,  3.77it/s]


 16%|█▌        | 865/5424 [03:56<20:11,  3.76it/s]

 16%|█▌        | 872/5424 [03:58<20:10,  3.76it/s]

 16%|█▌        | 880/5424 [04:00<20:12,  3.75it/s]


 17%|█▋        | 895/5424 [04:04<20:15,  3.73it/s]

 17%|█▋        | 902/5424 [04:06<20:31,  3.67it/s]

 17%|█▋        | 909/5424 [04:08<20:12,  3.72it/s]


 17%|█▋        | 924/5424 [04:12<20:00,  3.75it/s]

 17%|█▋        | 932/5424 [04:14<19:59,  3.74it/s]

 17%|█▋        | 939/5424 [04:16<19:53,  3.76it/s]


 18%|█▊        | 954/5424 [04:20<19:52,  3.75it/s]

 18%|█▊        | 962/5424 [04:22<19:51,  3.74it/s]

 18%|█▊        | 969/5424 [04:24<19:54,  3.73it/s]


 18%|█▊        | 984/5424 [04:28<20:27,  3.62it/s]

 18%|█▊        | 992/5424 [04:30<19:48,  3.73it/s]

 18%|█▊        | 999/5424 [04:32<19:57,  3.70it/s]


 19%|█▊        | 1014/5424 [04:36<19:36,  3.75it/s]

 19%|█▉        | 1020/5424 [04:37<19:44,  3.72it/s]

 19%|█▉        | 1029/5424 [04:40<20:08,  3.64it/s]


 19%|█▉        | 1044/5424 [04:44<19:26,  3.76it/s]

 19%|█▉        | 1052/5424 [04:46<19:22,  3.76it/s]

 20%|█▉        | 1059/5424 [04:48<19:17,  3.77it/s]


 20%|█▉        | 1074/5424 [04:52<19:26,  3.73it/s]

 20%|█▉        | 1081/5424 [04:54<19:32,  3.70it/s]

 20%|██        | 1089/5424 [04:56<19:25,  3.72it/s]


 20%|██        | 1104/5424 [05:00<19:14,  3.74it/s]

 20%|██        | 1111/5424 [05:02<19:27,  3.69it/s]

 21%|██        | 1119/5424 [05:04<19:09,  3.75it/s]


 21%|██        | 1134/5424 [05:08<19:11,  3.73it/s]

 21%|██        | 1141/5424 [05:10<19:23,  3.68it/s]

 21%|██        | 1148/5424 [05:12<19:19,  3.69it/s]


 21%|██▏       | 1163/5424 [05:16<18:52,  3.76it/s]

 22%|██▏       | 1171/5424 [05:18<19:04,  3.72it/s]

 22%|██▏       | 1178/5424 [05:20<18:56,  3.74it/s]


 22%|██▏       | 1193/5424 [05:24<18:49,  3.75it/s]

 22%|██▏       | 1201/5424 [05:26<18:50,  3.74it/s]

 22%|██▏       | 1208/5424 [05:28<18:38,  3.77it/s]


 23%|██▎       | 1223/5424 [05:32<18:43,  3.74it/s]

 23%|██▎       | 1231/5424 [05:34<18:40,  3.74it/s]

 23%|██▎       | 1238/5424 [05:36<18:32,  3.76it/s]


 23%|██▎       | 1253/5424 [05:40<18:39,  3.72it/s]

 23%|██▎       | 1261/5424 [05:42<18:38,  3.72it/s]

 23%|██▎       | 1268/5424 [05:44<18:42,  3.70it/s]


 24%|██▎       | 1283/5424 [05:48<18:22,  3.76it/s]

 24%|██▍       | 1291/5424 [05:50<18:26,  3.74it/s]

 24%|██▍       | 1298/5424 [05:52<18:46,  3.66it/s]


 24%|██▍       | 1313/5424 [05:56<18:26,  3.72it/s]

 24%|██▍       | 1320/5424 [05:58<18:06,  3.78it/s]


 25%|██▍       | 1335/5424 [06:02<18:29,  3.68it/s]

 25%|██▍       | 1343/5424 [06:04<18:14,  3.73it/s]

 25%|██▍       | 1350/5424 [06:06<18:04,  3.76it/s]

 25%|██▌       | 1356/5424 [06:08<18:14,  3.72it/s]
generating response...













 95%|█████████▍| 190/201 [00:25<00:01,  7.60it/s]

 25%|██▌       | 1363/5424 [07:42<3:59:44,  3.54s/it]

 25%|██▌       | 1370/5424 [07:44<36:46,  1.84it/s]


 26%|██▌       | 1385/5424 [07:48<18:34,  3.62it/s]

 26%|██▌       | 1392/5424 [07:50<19:06,  3.52it/s]


 26%|██▌       | 1406/5424 [07:54<18:39,  3.59it/s]

 26%|██▌       | 1414/5424 [07:56<18:27,  3.62it/s]

 26%|██▌       | 1421/5424 [07:58<18:30,  3.61it/s]


 26%|██▋       | 1435/5424 [08:02<18:17,  3.64it/s]

 27%|██▋       | 1442/5424 [08:04<18:48,  3.53it/s]

 27%|██▋       | 1450/5424 [08:06<18:23,  3.60it/s]


 27%|██▋       | 1464/5424 [08:10<18:16,  3.61it/s]

 27%|██▋       | 1471/5424 [08:12<18:30,  3.56it/s]

 27%|██▋       | 1479/5424 [08:14<18:07,  3.63it/s]


 28%|██▊       | 1493/5424 [08:18<18:30,  3.54it/s]

 28%|██▊       | 1500/5424 [08:20<18:16,  3.58it/s]


 28%|██▊       | 1515/5424 [08:24<17:51,  3.65it/s]

 28%|██▊       | 1522/5424 [08:26<18:04,  3.60it/s]

 28%|██▊       | 1529/5424 [08:28<17:48,  3.64it/s]


 28%|██▊       | 1544/5424 [08:32<17:47,  3.64it/s]

 29%|██▊       | 1551/5424 [08:34<18:03,  3.58it/s]

 29%|██▊       | 1558/5424 [08:36<17:38,  3.65it/s]


 29%|██▉       | 1573/5424 [08:40<17:48,  3.61it/s]

 29%|██▉       | 1580/5424 [08:42<17:56,  3.57it/s]


 29%|██▉       | 1594/5424 [08:46<17:31,  3.64it/s]

 30%|██▉       | 1602/5424 [08:48<17:45,  3.59it/s]

 30%|██▉       | 1609/5424 [08:50<17:39,  3.60it/s]


 30%|██▉       | 1623/5424 [08:54<17:29,  3.62it/s]

 30%|███       | 1630/5424 [08:56<17:25,  3.63it/s]


 30%|███       | 1645/5424 [09:00<17:29,  3.60it/s]

 30%|███       | 1652/5424 [09:02<17:32,  3.58it/s]

 31%|███       | 1660/5424 [09:04<17:09,  3.66it/s]


 31%|███       | 1674/5424 [09:08<17:09,  3.64it/s]

 31%|███       | 1681/5424 [09:10<17:26,  3.58it/s]

 31%|███       | 1689/5424 [09:12<16:58,  3.67it/s]


 31%|███▏      | 1703/5424 [09:16<17:19,  3.58it/s]

 32%|███▏      | 1711/5424 [09:18<16:56,  3.65it/s]


 32%|███▏      | 1725/5424 [09:22<16:58,  3.63it/s]

 32%|███▏      | 1732/5424 [09:24<16:54,  3.64it/s]

 32%|███▏      | 1740/5424 [09:26<16:46,  3.66it/s]


 32%|███▏      | 1754/5424 [09:30<16:44,  3.65it/s]

 32%|███▏      | 1762/5424 [09:32<16:56,  3.60it/s]

 33%|███▎      | 1769/5424 [09:34<16:43,  3.64it/s]



 33%|███▎      | 1790/5424 [09:40<17:16,  3.51it/s]
{'loss': 0.5017, 'grad_norm': 0.2004394233226776, 'learning_rate': 7.575026257670793e-06, 'rewards/margins': 0.6724768280982971, 'rewards/chosen': -0.23566222190856934, 'rewards/rejected': -0.9081390500068665, 'logps/margins': 21.811325073242188, 'logps/chosen': -18.859228134155273, 'logps/rejected': -40.670555114746094, 'accuracy': 0.6000000238418579, 'epoch': 0.98}


 33%|███▎      | 1805/5424 [09:44<16:35,  3.64it/s]

 33%|███▎      | 1812/5424 [09:46<16:43,  3.60it/s]

 34%|███▎      | 1819/5424 [09:48<16:26,  3.65it/s]


 34%|███▍      | 1834/5424 [09:52<16:22,  3.65it/s]

 34%|███▍      | 1841/5424 [09:54<16:28,  3.63it/s]

 34%|███▍      | 1848/5424 [09:56<16:18,  3.65it/s]


 34%|███▍      | 1863/5424 [10:00<16:21,  3.63it/s]

 34%|███▍      | 1870/5424 [10:02<16:34,  3.57it/s]


 35%|███▍      | 1885/5424 [10:07<16:11,  3.64it/s]

 35%|███▍      | 1892/5424 [10:08<16:16,  3.62it/s]

 35%|███▌      | 1899/5424 [10:10<16:04,  3.65it/s]


 35%|███▌      | 1914/5424 [10:15<16:01,  3.65it/s]

 35%|███▌      | 1921/5424 [10:16<16:10,  3.61it/s]


 36%|███▌      | 1935/5424 [10:20<16:09,  3.60it/s]

 36%|███▌      | 1943/5424 [10:23<16:02,  3.62it/s]

 36%|███▌      | 1950/5424 [10:25<15:54,  3.64it/s]


 36%|███▌      | 1965/5424 [10:29<15:50,  3.64it/s]

 36%|███▋      | 1971/5424 [10:30<16:03,  3.58it/s]

 36%|███▋      | 1979/5424 [10:33<16:02,  3.58it/s]


 37%|███▋      | 1993/5424 [10:36<15:46,  3.62it/s]

 37%|███▋      | 2000/5424 [10:38<16:03,  3.56it/s]


 37%|███▋      | 2015/5424 [10:43<15:36,  3.64it/s]

 37%|███▋      | 2020/5424 [10:44<15:42,  3.61it/s]

 37%|███▋      | 2028/5424 [10:46<15:41,  3.61it/s]


 38%|███▊      | 2042/5424 [10:50<15:50,  3.56it/s]

 38%|███▊      | 2049/5424 [10:52<15:36,  3.60it/s]


 38%|███▊      | 2064/5424 [10:56<15:24,  3.63it/s]

 38%|███▊      | 2071/5424 [10:58<15:31,  3.60it/s]

 38%|███▊      | 2078/5424 [11:00<15:23,  3.62it/s]


 39%|███▊      | 2092/5424 [11:04<15:33,  3.57it/s]

 39%|███▊      | 2100/5424 [11:06<15:12,  3.64it/s]

 39%|███▉      | 2107/5424 [11:08<15:11,  3.64it/s]


 39%|███▉      | 2121/5424 [11:12<15:14,  3.61it/s]

 39%|███▉      | 2128/5424 [11:14<15:35,  3.52it/s]


 40%|███▉      | 2143/5424 [11:18<15:20,  3.56it/s]

 40%|███▉      | 2150/5424 [11:20<15:01,  3.63it/s]

 40%|███▉      | 2157/5424 [11:22<15:05,  3.61it/s]


 40%|████      | 2172/5424 [11:26<14:55,  3.63it/s]

 40%|████      | 2179/5424 [11:28<15:10,  3.56it/s]


 40%|████      | 2193/5424 [11:32<14:50,  3.63it/s]

 41%|████      | 2201/5424 [11:34<14:49,  3.62it/s]


 41%|████      | 2215/5424 [11:38<14:48,  3.61it/s]

 41%|████      | 2222/5424 [11:40<14:58,  3.56it/s]

 41%|████      | 2230/5424 [11:42<14:41,  3.62it/s]


 41%|████▏     | 2244/5424 [11:46<14:46,  3.59it/s]

 42%|████▏     | 2251/5424 [11:48<14:44,  3.59it/s]

 42%|████▏     | 2258/5424 [11:50<14:45,  3.58it/s]


 42%|████▏     | 2273/5424 [11:54<14:41,  3.57it/s]

 42%|████▏     | 2280/5424 [11:56<14:43,  3.56it/s]

 42%|████▏     | 2287/5424 [11:58<14:19,  3.65it/s]


 42%|████▏     | 2302/5424 [12:02<14:27,  3.60it/s]

 43%|████▎     | 2309/5424 [12:04<14:10,  3.66it/s]


 43%|████▎     | 2323/5424 [12:08<14:21,  3.60it/s]

 43%|████▎     | 2331/5424 [12:10<14:20,  3.60it/s]

 43%|████▎     | 2338/5424 [12:12<14:16,  3.60it/s]


 43%|████▎     | 2352/5424 [12:16<14:04,  3.64it/s]

 44%|████▎     | 2360/5424 [12:18<13:58,  3.66it/s]

 44%|████▎     | 2367/5424 [12:20<14:01,  3.63it/s]


 44%|████▍     | 2381/5424 [12:24<13:58,  3.63it/s]

 44%|████▍     | 2389/5424 [12:26<14:00,  3.61it/s]


 44%|████▍     | 2403/5424 [12:30<13:52,  3.63it/s]

 44%|████▍     | 2410/5424 [12:32<13:54,  3.61it/s]

 45%|████▍     | 2417/5424 [12:34<13:56,  3.60it/s]


 45%|████▍     | 2432/5424 [12:38<13:46,  3.62it/s]

 45%|████▍     | 2439/5424 [12:40<13:39,  3.64it/s]

 45%|████▌     | 2447/5424 [12:42<13:38,  3.64it/s]


 45%|████▌     | 2461/5424 [12:46<13:42,  3.60it/s]

 46%|████▌     | 2468/5424 [12:48<13:41,  3.60it/s]

 46%|████▌     | 2475/5424 [12:50<13:31,  3.63it/s]


 46%|████▌     | 2490/5424 [12:54<13:25,  3.64it/s]

 46%|████▌     | 2497/5424 [12:56<13:29,  3.62it/s]


 46%|████▋     | 2512/5424 [13:00<13:23,  3.62it/s]

 46%|████▋     | 2519/5424 [13:02<13:21,  3.62it/s]

 47%|████▋     | 2526/5424 [13:04<13:17,  3.63it/s]


 47%|████▋     | 2540/5424 [13:08<13:35,  3.54it/s]

 47%|████▋     | 2548/5424 [13:10<13:19,  3.60it/s]


 47%|████▋     | 2562/5424 [13:14<13:12,  3.61it/s]

 47%|████▋     | 2569/5424 [13:16<13:14,  3.59it/s]

 47%|████▋     | 2576/5424 [13:18<13:28,  3.52it/s]


 48%|████▊     | 2591/5424 [13:22<13:16,  3.56it/s]

 48%|████▊     | 2598/5424 [13:24<13:14,  3.55it/s]

 48%|████▊     | 2605/5424 [13:26<12:57,  3.62it/s]


 48%|████▊     | 2619/5424 [13:30<13:44,  3.40it/s]

 48%|████▊     | 2627/5424 [13:33<12:54,  3.61it/s]


 49%|████▊     | 2641/5424 [13:36<12:52,  3.60it/s]

 49%|████▉     | 2648/5424 [13:38<12:41,  3.65it/s]

 49%|████▉     | 2656/5424 [13:41<12:44,  3.62it/s]


 49%|████▉     | 2670/5424 [13:44<12:36,  3.64it/s]

 49%|████▉     | 2677/5424 [13:46<12:32,  3.65it/s]


 50%|████▉     | 2692/5424 [13:50<12:47,  3.56it/s]

 50%|████▉     | 2699/5424 [13:52<12:37,  3.60it/s]

 50%|████▉     | 2706/5424 [13:54<12:42,  3.56it/s]

 50%|█████     | 2712/5424 [13:56<12:34,  3.59it/s]
generating response...













 94%|█████████▍| 189/201 [00:25<00:01,  7.56it/s]

 50%|█████     | 2718/5424 [14:59<2:30:49,  3.34s/it]


 50%|█████     | 2732/5424 [15:02<13:35,  3.30it/s]

 51%|█████     | 2740/5424 [15:05<12:18,  3.63it/s]

 51%|█████     | 2747/5424 [15:07<12:29,  3.57it/s]


 51%|█████     | 2761/5424 [15:11<12:19,  3.60it/s]

 51%|█████     | 2769/5424 [15:13<12:10,  3.63it/s]

 51%|█████     | 2776/5424 [15:15<12:04,  3.65it/s]


 51%|█████▏    | 2790/5424 [15:19<12:30,  3.51it/s]

 52%|█████▏    | 2797/5424 [15:21<12:03,  3.63it/s]


 52%|█████▏    | 2812/5424 [15:25<12:08,  3.59it/s]

 52%|█████▏    | 2819/5424 [15:27<12:01,  3.61it/s]

 52%|█████▏    | 2826/5424 [15:29<12:02,  3.60it/s]


 52%|█████▏    | 2840/5424 [15:33<11:50,  3.64it/s]

 53%|█████▎    | 2848/5424 [15:35<11:52,  3.62it/s]


 53%|█████▎    | 2862/5424 [15:39<11:53,  3.59it/s]

 53%|█████▎    | 2869/5424 [15:41<11:40,  3.64it/s]

 53%|█████▎    | 2877/5424 [15:43<11:38,  3.64it/s]


 53%|█████▎    | 2891/5424 [15:47<11:55,  3.54it/s]

 53%|█████▎    | 2898/5424 [15:49<11:37,  3.62it/s]

 54%|█████▎    | 2906/5424 [15:51<11:39,  3.60it/s]


 54%|█████▍    | 2920/5424 [15:55<11:39,  3.58it/s]

 54%|█████▍    | 2927/5424 [15:57<11:46,  3.53it/s]


 54%|█████▍    | 2942/5424 [16:01<11:27,  3.61it/s]

 54%|█████▍    | 2949/5424 [16:03<11:27,  3.60it/s]

 54%|█████▍    | 2956/5424 [16:05<11:21,  3.62it/s]


 55%|█████▍    | 2971/5424 [16:09<11:38,  3.51it/s]

 55%|█████▍    | 2978/5424 [16:11<11:14,  3.63it/s]


 55%|█████▌    | 2992/5424 [16:15<11:12,  3.61it/s]

 55%|█████▌    | 3000/5424 [16:17<11:09,  3.62it/s]

 55%|█████▌    | 3007/5424 [16:19<11:25,  3.52it/s]


 56%|█████▌    | 3021/5424 [16:23<11:09,  3.59it/s]

 56%|█████▌    | 3028/5424 [16:25<11:05,  3.60it/s]

 56%|█████▌    | 3036/5424 [16:27<10:58,  3.63it/s]


 56%|█████▌    | 3050/5424 [16:31<10:56,  3.62it/s]

 56%|█████▋    | 3057/5424 [16:33<11:04,  3.56it/s]


 57%|█████▋    | 3071/5424 [16:37<11:02,  3.55it/s]

 57%|█████▋    | 3078/5424 [16:39<10:55,  3.58it/s]

 57%|█████▋    | 3086/5424 [16:41<10:59,  3.55it/s]


 57%|█████▋    | 3100/5424 [16:45<10:37,  3.65it/s]

 57%|█████▋    | 3107/5424 [16:47<10:36,  3.64it/s]


 58%|█████▊    | 3122/5424 [16:51<10:36,  3.62it/s]

 58%|█████▊    | 3129/5424 [16:53<10:31,  3.64it/s]

 58%|█████▊    | 3136/5424 [16:55<10:30,  3.63it/s]


 58%|█████▊    | 3151/5424 [16:59<10:34,  3.58it/s]

 58%|█████▊    | 3158/5424 [17:01<10:31,  3.59it/s]


 58%|█████▊    | 3173/5424 [17:05<10:29,  3.58it/s]

 59%|█████▊    | 3180/5424 [17:07<10:17,  3.64it/s]

 59%|█████▉    | 3187/5424 [17:09<10:37,  3.51it/s]


 59%|█████▉    | 3201/5424 [17:13<10:23,  3.56it/s]

 59%|█████▉    | 3208/5424 [17:15<10:16,  3.60it/s]


 59%|█████▉    | 3223/5424 [17:19<10:07,  3.62it/s]

 60%|█████▉    | 3230/5424 [17:21<10:00,  3.65it/s]

 60%|█████▉    | 3237/5424 [17:23<10:02,  3.63it/s]


 60%|█████▉    | 3252/5424 [17:27<09:58,  3.63it/s]

 60%|██████    | 3259/5424 [17:29<09:53,  3.65it/s]

 60%|██████    | 3266/5424 [17:31<10:05,  3.56it/s]


 60%|██████    | 3281/5424 [17:35<09:51,  3.62it/s]

 61%|██████    | 3288/5424 [17:37<09:49,  3.62it/s]


 61%|██████    | 3302/5424 [17:41<09:46,  3.62it/s]

 61%|██████    | 3309/5424 [17:43<09:51,  3.57it/s]

 61%|██████    | 3317/5424 [17:45<09:56,  3.53it/s]


 61%|██████▏   | 3331/5424 [17:49<09:37,  3.63it/s]

 62%|██████▏   | 3338/5424 [17:51<09:39,  3.60it/s]


 62%|██████▏   | 3353/5424 [17:55<09:29,  3.64it/s]

 62%|██████▏   | 3360/5424 [17:57<09:31,  3.61it/s]

 62%|██████▏   | 3367/5424 [17:59<09:37,  3.56it/s]


 62%|██████▏   | 3382/5424 [18:03<09:28,  3.59it/s]

 62%|██████▏   | 3389/5424 [18:05<09:22,  3.61it/s]

 63%|██████▎   | 3396/5424 [18:07<09:19,  3.62it/s]


 63%|██████▎   | 3411/5424 [18:11<09:15,  3.62it/s]

 63%|██████▎   | 3418/5424 [18:13<09:12,  3.63it/s]


 63%|██████▎   | 3432/5424 [18:17<09:11,  3.61it/s]

 63%|██████▎   | 3440/5424 [18:19<09:07,  3.63it/s]

 64%|██████▎   | 3447/5424 [18:21<09:12,  3.58it/s]


 64%|██████▍   | 3461/5424 [18:25<09:13,  3.55it/s]

 64%|██████▍   | 3468/5424 [18:27<09:02,  3.61it/s]


 64%|██████▍   | 3483/5424 [18:31<08:59,  3.60it/s]

 64%|██████▍   | 3490/5424 [18:33<08:59,  3.59it/s]

 64%|██████▍   | 3497/5424 [18:35<08:49,  3.64it/s]


 65%|██████▍   | 3511/5424 [18:39<08:54,  3.58it/s]

 65%|██████▍   | 3519/5424 [18:41<08:45,  3.63it/s]

 65%|██████▌   | 3526/5424 [18:43<08:55,  3.55it/s]


 65%|██████▌   | 3540/5424 [18:47<08:41,  3.61it/s]

 65%|██████▌   | 3547/5424 [18:49<08:42,  3.59it/s]


 66%|██████▌   | 3562/5424 [18:53<08:38,  3.59it/s]

 66%|██████▌   | 3569/5424 [18:55<08:37,  3.59it/s]

 66%|██████▌   | 3576/5424 [18:57<08:46,  3.51it/s]


 66%|██████▌   | 3591/5424 [19:01<08:30,  3.59it/s]

 66%|██████▋   | 3598/5424 [19:03<08:24,  3.62it/s]


 67%|██████▋   | 3612/5424 [19:07<08:27,  3.57it/s]

 67%|██████▋   | 3619/5424 [19:09<08:22,  3.60it/s]

 67%|██████▋   | 3627/5424 [19:11<08:27,  3.54it/s]


 67%|██████▋   | 3641/5424 [19:15<08:21,  3.56it/s]

 67%|██████▋   | 3648/5424 [19:17<08:10,  3.62it/s]


 68%|██████▊   | 3663/5424 [19:21<08:06,  3.62it/s]

 68%|██████▊   | 3670/5424 [19:23<08:07,  3.59it/s]

 68%|██████▊   | 3677/5424 [19:25<08:05,  3.60it/s]


 68%|██████▊   | 3691/5424 [19:29<08:02,  3.59it/s]

 68%|██████▊   | 3699/5424 [19:31<07:57,  3.61it/s]

 68%|██████▊   | 3706/5424 [19:33<07:53,  3.63it/s]


 69%|██████▊   | 3720/5424 [19:37<07:59,  3.55it/s]

 69%|██████▊   | 3727/5424 [19:39<07:51,  3.60it/s]


 69%|██████▉   | 3742/5424 [19:43<07:59,  3.51it/s]

 69%|██████▉   | 3749/5424 [19:45<07:41,  3.63it/s]

 69%|██████▉   | 3756/5424 [19:47<07:42,  3.61it/s]


 70%|██████▉   | 3770/5424 [19:51<08:01,  3.43it/s]

 70%|██████▉   | 3777/5424 [19:53<07:37,  3.60it/s]


 70%|██████▉   | 3791/5424 [19:57<07:31,  3.62it/s]

 70%|███████   | 3799/5424 [19:59<07:27,  3.63it/s]


 70%|███████   | 3813/5424 [20:03<07:32,  3.56it/s]

 70%|███████   | 3820/5424 [20:05<07:25,  3.60it/s]

 71%|███████   | 3827/5424 [20:07<07:33,  3.52it/s]


 71%|███████   | 3842/5424 [20:11<07:17,  3.62it/s]

 71%|███████   | 3849/5424 [20:13<07:13,  3.64it/s]

 71%|███████   | 3856/5424 [20:15<07:15,  3.60it/s]


 71%|███████▏  | 3871/5424 [20:19<07:12,  3.59it/s]

 71%|███████▏  | 3878/5424 [20:21<07:05,  3.63it/s]


 72%|███████▏  | 3892/5424 [20:25<07:13,  3.54it/s]

 72%|███████▏  | 3899/5424 [20:27<07:05,  3.58it/s]

 72%|███████▏  | 3907/5424 [20:29<06:58,  3.62it/s]


 72%|███████▏  | 3921/5424 [20:33<06:58,  3.60it/s]

 72%|███████▏  | 3928/5424 [20:35<06:58,  3.57it/s]


 73%|███████▎  | 3943/5424 [20:39<06:47,  3.63it/s]

 73%|███████▎  | 3950/5424 [20:41<06:44,  3.65it/s]

 73%|███████▎  | 3957/5424 [20:43<06:47,  3.60it/s]


 73%|███████▎  | 3972/5424 [20:47<06:40,  3.63it/s]

 73%|███████▎  | 3979/5424 [20:49<06:36,  3.64it/s]

 73%|███████▎  | 3986/5424 [20:51<06:38,  3.61it/s]


 74%|███████▎  | 4000/5424 [20:55<06:40,  3.55it/s]

 74%|███████▍  | 4006/5424 [20:57<06:34,  3.59it/s]


 74%|███████▍  | 4020/5424 [21:01<06:38,  3.52it/s]

 74%|███████▍  | 4027/5424 [21:03<06:34,  3.54it/s]

 74%|███████▍  | 4035/5424 [21:05<06:27,  3.58it/s]


 75%|███████▍  | 4049/5424 [21:09<06:20,  3.61it/s]

 75%|███████▍  | 4056/5424 [21:11<06:18,  3.62it/s]

 75%|███████▍  | 4064/5424 [21:13<06:22,  3.55it/s]

 75%|███████▌  | 4068/5424 [21:14<06:14,  3.62it/s]













 94%|█████████▍| 189/201 [00:25<00:01,  7.52it/s]

 75%|███████▌  | 4071/5424 [22:17<3:32:22,  9.42s/it]

 75%|███████▌  | 4078/5424 [22:19<23:10,  1.03s/it]

 75%|███████▌  | 4085/5424 [22:21<07:34,  2.95it/s]


 76%|███████▌  | 4099/5424 [22:25<06:07,  3.61it/s]

 76%|███████▌  | 4106/5424 [22:27<06:17,  3.49it/s]


 76%|███████▌  | 4121/5424 [22:31<06:01,  3.61it/s]

 76%|███████▌  | 4128/5424 [22:33<05:56,  3.64it/s]

 76%|███████▌  | 4135/5424 [22:35<05:55,  3.63it/s]


 77%|███████▋  | 4150/5424 [22:39<05:51,  3.63it/s]

 77%|███████▋  | 4157/5424 [22:41<05:53,  3.58it/s]


 77%|███████▋  | 4171/5424 [22:45<05:46,  3.61it/s]

 77%|███████▋  | 4179/5424 [22:47<05:47,  3.58it/s]

 77%|███████▋  | 4186/5424 [22:49<05:42,  3.61it/s]


 77%|███████▋  | 4200/5424 [22:53<05:36,  3.64it/s]

 78%|███████▊  | 4208/5424 [22:55<05:29,  3.69it/s]

 78%|███████▊  | 4215/5424 [22:57<05:28,  3.68it/s]


 78%|███████▊  | 4230/5424 [23:01<05:27,  3.64it/s]

 78%|███████▊  | 4237/5424 [23:03<05:21,  3.69it/s]


 78%|███████▊  | 4252/5424 [23:07<05:20,  3.65it/s]

 79%|███████▊  | 4259/5424 [23:09<05:15,  3.69it/s]

 79%|███████▊  | 4266/5424 [23:11<05:12,  3.70it/s]


 79%|███████▉  | 4281/5424 [23:15<05:10,  3.68it/s]

 79%|███████▉  | 4289/5424 [23:17<05:08,  3.68it/s]

 79%|███████▉  | 4296/5424 [23:19<05:04,  3.71it/s]


 79%|███████▉  | 4311/5424 [23:23<05:03,  3.67it/s]

 80%|███████▉  | 4318/5424 [23:25<05:00,  3.68it/s]

 80%|███████▉  | 4325/5424 [23:27<05:01,  3.65it/s]


 80%|████████  | 4340/5424 [23:31<04:56,  3.66it/s]

 80%|████████  | 4347/5424 [23:33<04:54,  3.66it/s]


 80%|████████  | 4362/5424 [23:37<04:47,  3.69it/s]

 81%|████████  | 4369/5424 [23:39<04:44,  3.70it/s]

 81%|████████  | 4377/5424 [23:41<04:43,  3.69it/s]


 81%|████████  | 4392/5424 [23:45<04:38,  3.70it/s]

 81%|████████  | 4399/5424 [23:47<04:39,  3.67it/s]

 81%|████████  | 4406/5424 [23:49<04:34,  3.71it/s]


 82%|████████▏ | 4421/5424 [23:53<04:39,  3.59it/s]

 82%|████████▏ | 4428/5424 [23:55<04:32,  3.65it/s]

 82%|████████▏ | 4436/5424 [23:57<04:27,  3.69it/s]


 82%|████████▏ | 4450/5424 [24:01<04:25,  3.67it/s]

 82%|████████▏ | 4458/5424 [24:03<04:23,  3.67it/s]

 82%|████████▏ | 4465/5424 [24:05<04:18,  3.70it/s]


 83%|████████▎ | 4480/5424 [24:09<04:16,  3.68it/s]

 83%|████████▎ | 4487/5424 [24:11<04:12,  3.71it/s]


 83%|████████▎ | 4502/5424 [24:15<04:11,  3.67it/s]

 83%|████████▎ | 4509/5424 [24:17<04:09,  3.67it/s]

 83%|████████▎ | 4517/5424 [24:19<04:05,  3.70it/s]


 84%|████████▎ | 4531/5424 [24:23<04:06,  3.62it/s]

 84%|████████▎ | 4539/5424 [24:25<03:59,  3.70it/s]

 84%|████████▍ | 4546/5424 [24:27<04:00,  3.66it/s]


 84%|████████▍ | 4560/5424 [24:31<03:56,  3.65it/s]

 84%|████████▍ | 4568/5424 [24:33<03:51,  3.71it/s]

 84%|████████▍ | 4575/5424 [24:35<03:53,  3.64it/s]


 85%|████████▍ | 4590/5424 [24:39<03:45,  3.70it/s]

 85%|████████▍ | 4598/5424 [24:42<03:47,  3.63it/s]

 85%|████████▍ | 4605/5424 [24:43<03:40,  3.72it/s]


 85%|████████▌ | 4620/5424 [24:47<03:36,  3.72it/s]

 85%|████████▌ | 4627/5424 [24:49<03:35,  3.69it/s]


 86%|████████▌ | 4642/5424 [24:53<03:32,  3.68it/s]

 86%|████████▌ | 4649/5424 [24:55<03:30,  3.69it/s]

 86%|████████▌ | 4657/5424 [24:58<03:28,  3.68it/s]


 86%|████████▌ | 4671/5424 [25:01<03:26,  3.64it/s]

 86%|████████▋ | 4679/5424 [25:04<03:22,  3.67it/s]

 86%|████████▋ | 4686/5424 [25:06<03:29,  3.52it/s]


 87%|████████▋ | 4701/5424 [25:10<03:19,  3.62it/s]

 87%|████████▋ | 4708/5424 [25:12<03:16,  3.65it/s]

 87%|████████▋ | 4715/5424 [25:13<03:10,  3.71it/s]


 87%|████████▋ | 4730/5424 [25:18<03:09,  3.66it/s]

 87%|████████▋ | 4737/5424 [25:19<03:08,  3.64it/s]


 88%|████████▊ | 4752/5424 [25:24<03:03,  3.67it/s]

 88%|████████▊ | 4759/5424 [25:25<02:59,  3.70it/s]

 88%|████████▊ | 4767/5424 [25:28<03:00,  3.65it/s]


 88%|████████▊ | 4782/5424 [25:32<02:54,  3.67it/s]

 88%|████████▊ | 4789/5424 [25:34<02:52,  3.68it/s]

 88%|████████▊ | 4796/5424 [25:35<02:49,  3.71it/s]


 89%|████████▊ | 4811/5424 [25:40<02:45,  3.70it/s]

 89%|████████▉ | 4819/5424 [25:42<02:43,  3.70it/s]

 89%|████████▉ | 4826/5424 [25:44<02:42,  3.68it/s]


 89%|████████▉ | 4841/5424 [25:48<02:42,  3.60it/s]

 89%|████████▉ | 4848/5424 [25:50<02:35,  3.71it/s]

 90%|████████▉ | 4855/5424 [25:51<02:36,  3.63it/s]


 90%|████████▉ | 4870/5424 [25:56<02:29,  3.71it/s]

 90%|████████▉ | 4877/5424 [25:57<02:33,  3.57it/s]


 90%|█████████ | 4892/5424 [26:02<02:25,  3.65it/s]

 90%|█████████ | 4900/5424 [26:04<02:22,  3.67it/s]

 90%|█████████ | 4907/5424 [26:06<02:19,  3.70it/s]


 91%|█████████ | 4922/5424 [26:10<02:18,  3.63it/s]

 91%|█████████ | 4929/5424 [26:12<02:15,  3.66it/s]

 91%|█████████ | 4936/5424 [26:14<02:13,  3.65it/s]


 91%|█████████▏| 4951/5424 [26:18<02:07,  3.70it/s]

 91%|█████████▏| 4959/5424 [26:20<02:05,  3.72it/s]

 92%|█████████▏| 4966/5424 [26:22<02:03,  3.71it/s]


 92%|█████████▏| 4981/5424 [26:26<02:00,  3.68it/s]

 92%|█████████▏| 4988/5424 [26:28<02:01,  3.60it/s]

 92%|█████████▏| 4996/5424 [26:30<01:55,  3.70it/s]


 92%|█████████▏| 5010/5424 [26:34<01:51,  3.70it/s]

 93%|█████████▎| 5018/5424 [26:36<01:49,  3.71it/s]

 93%|█████████▎| 5025/5424 [26:38<01:47,  3.70it/s]


 93%|█████████▎| 5040/5424 [26:42<01:43,  3.71it/s]

 93%|█████████▎| 5047/5424 [26:44<01:43,  3.64it/s]


 93%|█████████▎| 5062/5424 [26:48<01:38,  3.67it/s]

 93%|█████████▎| 5069/5424 [26:50<01:36,  3.67it/s]

 94%|█████████▎| 5077/5424 [26:52<01:34,  3.67it/s]


 94%|█████████▍| 5091/5424 [26:56<01:29,  3.70it/s]

 94%|█████████▍| 5099/5424 [26:58<01:27,  3.71it/s]

 94%|█████████▍| 5106/5424 [27:00<01:25,  3.71it/s]


 94%|█████████▍| 5121/5424 [27:04<01:22,  3.67it/s]

 95%|█████████▍| 5128/5424 [27:06<01:21,  3.64it/s]

 95%|█████████▍| 5136/5424 [27:08<01:19,  3.63it/s]


 95%|█████████▍| 5150/5424 [27:12<01:14,  3.69it/s]

 95%|█████████▌| 5157/5424 [27:14<01:12,  3.70it/s]


 95%|█████████▌| 5172/5424 [27:18<01:08,  3.68it/s]

 95%|█████████▌| 5179/5424 [27:20<01:06,  3.71it/s]

 96%|█████████▌| 5187/5424 [27:22<01:04,  3.66it/s]


 96%|█████████▌| 5202/5424 [27:26<01:00,  3.70it/s]

 96%|█████████▌| 5209/5424 [27:28<00:58,  3.70it/s]

 96%|█████████▌| 5216/5424 [27:30<00:57,  3.61it/s]


 96%|█████████▋| 5231/5424 [27:34<00:52,  3.66it/s]

 97%|█████████▋| 5238/5424 [27:36<00:50,  3.67it/s]

 97%|█████████▋| 5246/5424 [27:38<00:48,  3.70it/s]


 97%|█████████▋| 5260/5424 [27:42<00:44,  3.67it/s]

 97%|█████████▋| 5268/5424 [27:44<00:42,  3.69it/s]


 97%|█████████▋| 5282/5424 [27:48<00:39,  3.64it/s]

 98%|█████████▊| 5289/5424 [27:50<00:36,  3.70it/s]

 98%|█████████▊| 5297/5424 [27:52<00:34,  3.71it/s]


 98%|█████████▊| 5311/5424 [27:56<00:30,  3.65it/s]

 98%|█████████▊| 5319/5424 [27:58<00:28,  3.70it/s]

 98%|█████████▊| 5326/5424 [28:00<00:26,  3.66it/s]


 98%|█████████▊| 5341/5424 [28:04<00:22,  3.71it/s]

 99%|█████████▊| 5348/5424 [28:06<00:21,  3.62it/s]


 99%|█████████▉| 5363/5424 [28:10<00:16,  3.65it/s]

 99%|█████████▉| 5370/5424 [28:12<00:14,  3.70it/s]

 99%|█████████▉| 5377/5424 [28:14<00:12,  3.67it/s]


 99%|█████████▉| 5392/5424 [28:18<00:08,  3.62it/s]

100%|█████████▉| 5399/5424 [28:20<00:06,  3.70it/s]

100%|█████████▉| 5407/5424 [28:22<00:04,  3.69it/s]


100%|█████████▉| 5421/5424 [28:26<00:00,  3.68it/s]
{'loss': 0.5753, 'grad_norm': 0.16762156784534454, 'learning_rate': 4.1097167587933476e-11, 'rewards/margins': 0.7247591614723206, 'rewards/chosen': -0.5030540823936462, 'rewards/rejected': -1.2278131246566772, 'logps/margins': 14.20973014831543, 'logps/chosen': -22.40653419494629, 'logps/rejected': -36.61626434326172, 'accuracy': 0.699999988079071, 'epoch': 3.0}

100%|██████████| 5424/5424 [28:27<00:00,  3.67it/s]













 95%|█████████▌| 191/201 [00:25<00:01,  7.54it/s]
{'eval_loss': 0.5851590037345886, 'eval_accuracy': 0.7512437810945274, 'eval_runtime': 50.7819, 'eval_samples_per_second': 3.958, 'eval_steps_per_second': 3.958, 'eval_rewards/margins': 0.5758410692214966, 'eval_rewards/chosen': -0.5585147142410278, 'eval_rewards/rejected': -1.1343557834625244, 'eval_logps/margins': 14.556156158447266, 'eval_logps/chosen': -22.039636611938477, 'eval_logps/rejected': -36.59579086303711, 'epoch': 3.0}

100%|██████████| 5424/5424 [29:28<00:00,  3.07it/s]
loading model...
Downloading shards: 100%|██████████| 6/6 [00:00<00:00, 893.07it/s]



Loading checkpoint shards:  67%|██████▋   | 4/6 [00:06<00:02,  1.48s/it]
LlamaForCausalLM(
  (model): LlamaModel(
    (embed_tokens): Embedding(32000, 5120, padding_idx=0)
    (layers): ModuleList(
      (0-39): 40 x LlamaDecoderLayer(
        (self_attn): LlamaSdpaAttention(
          (q_proj): Linear(in_features=5120, out_features=5120, bias=False)
          (k_proj): Linear(in_features=5120, out_features=5120, bias=False)
          (v_proj): Linear(in_features=5120, out_features=5120, bias=False)
          (o_proj): Linear(in_features=5120, out_features=5120, bias=False)
          (rotary_emb): LlamaRotaryEmbedding()
        )
        (mlp): LlamaMLP(
          (gate_proj): Linear(in_features=5120, out_features=13824, bias=False)
          (up_proj): Linear(in_features=5120, out_features=13824, bias=False)
          (down_proj): Linear(in_features=13824, out_features=5120, bias=False)
          (act_fn): SiLU()
        )
        (input_layernorm): LlamaRMSNorm()
        (post_attention_layernorm): LlamaRMSNorm()
      )
    )
    (norm): LlamaRMSNorm()
  )
  (lm_head): Linear(in_features=5120, out_features=32000, bias=False)
)

Loading checkpoint shards: 100%|██████████| 6/6 [00:08<00:00,  1.34s/it]
mapping dataset to standard format...
Map (num_proc=4): 100%|██████████| 1808/1808 [00:00<00:00, 8988.87 examples/s]
mapping dataset to standard format...
start training...
Map (num_proc=4): 100%|██████████| 201/201 [00:00<00:00, 1356.19 examples/s]
dataset preprocessing...
Map (num_proc=4): 100%|██████████| 1808/1808 [00:00<00:00, 3241.07 examples/s]
Filter: 100%|██████████| 1808/1808 [00:00<00:00, 3239.18 examples/s]
Map (num_proc=4):  25%|██▌       | 51/201 [00:00<00:00, 307.37 examples/s]
train_dataset_retain: 1.0
eval_dataset_retain: 1.0
Map (num_proc=4): 100%|██████████| 201/201 [00:00<00:00, 637.24 examples/s]
Filter: 100%|██████████| 201/201 [00:00<00:00, 3137.74 examples/s]
  0%|          | 0/5424 [00:00<?, ?it/s]You're using a LlamaTokenizerFast tokenizer. Please note that with a fast tokenizer, using the `__call__` method is faster than using a method to encode the text followed by a call to the `pad` method to get a padded encoding.
  0%|          | 4/5424 [00:01<26:23,  3.42it/s]


  0%|          | 18/5424 [00:05<25:12,  3.57it/s]

  0%|          | 26/5424 [00:07<24:56,  3.61it/s]


  1%|          | 40/5424 [00:11<24:39,  3.64it/s]

  1%|          | 47/5424 [00:13<24:41,  3.63it/s]

  1%|          | 55/5424 [00:15<24:35,  3.64it/s]


  1%|▏         | 69/5424 [00:19<25:11,  3.54it/s]

  1%|▏         | 76/5424 [00:21<26:17,  3.39it/s]


  2%|▏         | 90/5424 [00:25<24:57,  3.56it/s]

  2%|▏         | 97/5424 [00:27<24:53,  3.57it/s]

  2%|▏         | 104/5424 [00:29<25:06,  3.53it/s]


  2%|▏         | 118/5424 [00:33<24:31,  3.61it/s]

  2%|▏         | 126/5424 [00:35<24:40,  3.58it/s]


  3%|▎         | 140/5424 [00:39<24:43,  3.56it/s]

  3%|▎         | 147/5424 [00:41<24:21,  3.61it/s]

  3%|▎         | 154/5424 [00:43<24:26,  3.59it/s]


  3%|▎         | 169/5424 [00:47<24:15,  3.61it/s]

  3%|▎         | 176/5424 [00:49<24:10,  3.62it/s]


  4%|▎         | 190/5424 [00:53<24:11,  3.61it/s]

  4%|▎         | 198/5424 [00:55<24:08,  3.61it/s]

  4%|▍         | 205/5424 [00:57<24:11,  3.59it/s]


  4%|▍         | 219/5424 [01:01<23:59,  3.62it/s]

  4%|▍         | 226/5424 [01:03<24:23,  3.55it/s]


  4%|▍         | 241/5424 [01:07<24:06,  3.58it/s]

  5%|▍         | 248/5424 [01:09<24:02,  3.59it/s]

  5%|▍         | 255/5424 [01:11<24:02,  3.58it/s]


  5%|▍         | 269/5424 [01:15<24:01,  3.58it/s]

  5%|▌         | 277/5424 [01:17<23:40,  3.62it/s]


  5%|▌         | 291/5424 [01:21<24:03,  3.56it/s]

  5%|▌         | 298/5424 [01:23<23:43,  3.60it/s]

  6%|▌         | 305/5424 [01:25<24:03,  3.55it/s]


  6%|▌         | 320/5424 [01:29<23:54,  3.56it/s]

  6%|▌         | 327/5424 [01:31<23:46,  3.57it/s]


  6%|▋         | 341/5424 [01:35<23:53,  3.55it/s]

  6%|▋         | 348/5424 [01:37<23:25,  3.61it/s]

  7%|▋         | 355/5424 [01:39<24:23,  3.46it/s]


  7%|▋         | 370/5424 [01:43<23:12,  3.63it/s]

  7%|▋         | 377/5424 [01:45<23:17,  3.61it/s]

  7%|▋         | 384/5424 [01:47<23:18,  3.60it/s]


  7%|▋         | 398/5424 [01:51<23:38,  3.54it/s]

  7%|▋         | 405/5424 [01:53<23:32,  3.55it/s]


  8%|▊         | 419/5424 [01:57<23:22,  3.57it/s]

  8%|▊         | 427/5424 [01:59<23:14,  3.58it/s]


  8%|▊         | 441/5424 [02:03<23:09,  3.59it/s]

  8%|▊         | 448/5424 [02:05<23:18,  3.56it/s]

  8%|▊         | 455/5424 [02:07<23:00,  3.60it/s]


  9%|▊         | 470/5424 [02:11<22:48,  3.62it/s]

  9%|▉         | 477/5424 [02:13<23:11,  3.56it/s]


  9%|▉         | 491/5424 [02:17<23:23,  3.51it/s]

  9%|▉         | 498/5424 [02:19<23:10,  3.54it/s]

  9%|▉         | 505/5424 [02:21<22:48,  3.59it/s]


 10%|▉         | 520/5424 [02:25<22:45,  3.59it/s]

 10%|▉         | 527/5424 [02:27<23:16,  3.51it/s]


 10%|▉         | 541/5424 [02:31<22:43,  3.58it/s]

 10%|█         | 548/5424 [02:33<22:27,  3.62it/s]

 10%|█         | 556/5424 [02:35<22:36,  3.59it/s]


 11%|█         | 570/5424 [02:39<22:18,  3.63it/s]

 11%|█         | 577/5424 [02:41<22:17,  3.62it/s]

 11%|█         | 584/5424 [02:43<22:15,  3.62it/s]


 11%|█         | 599/5424 [02:47<22:09,  3.63it/s]

 11%|█         | 606/5424 [02:49<22:20,  3.60it/s]


 11%|█▏        | 621/5424 [02:53<22:10,  3.61it/s]

 12%|█▏        | 628/5424 [02:55<22:11,  3.60it/s]

 12%|█▏        | 635/5424 [02:57<22:33,  3.54it/s]


 12%|█▏        | 649/5424 [03:01<22:12,  3.58it/s]

 12%|█▏        | 656/5424 [03:03<22:01,  3.61it/s]


 12%|█▏        | 671/5424 [03:07<21:55,  3.61it/s]

 12%|█▎        | 678/5424 [03:09<21:46,  3.63it/s]

 13%|█▎        | 685/5424 [03:11<22:22,  3.53it/s]


 13%|█▎        | 699/5424 [03:15<21:40,  3.63it/s]

 13%|█▎        | 707/5424 [03:17<21:37,  3.64it/s]


 13%|█▎        | 721/5424 [03:21<21:52,  3.58it/s]

 13%|█▎        | 728/5424 [03:23<22:12,  3.52it/s]

 14%|█▎        | 735/5424 [03:25<21:58,  3.56it/s]


 14%|█▍        | 749/5424 [03:29<21:37,  3.60it/s]

 14%|█▍        | 757/5424 [03:31<21:35,  3.60it/s]


 14%|█▍        | 771/5424 [03:35<21:46,  3.56it/s]

 14%|█▍        | 778/5424 [03:37<21:23,  3.62it/s]

 14%|█▍        | 785/5424 [03:39<21:22,  3.62it/s]


 15%|█▍        | 800/5424 [03:43<21:36,  3.57it/s]

 15%|█▍        | 807/5424 [03:45<21:37,  3.56it/s]


 15%|█▌        | 821/5424 [03:49<21:15,  3.61it/s]

 15%|█▌        | 828/5424 [03:51<21:15,  3.60it/s]

 15%|█▌        | 836/5424 [03:53<21:09,  3.61it/s]


 16%|█▌        | 850/5424 [03:57<21:06,  3.61it/s]

 16%|█▌        | 857/5424 [03:59<21:24,  3.55it/s]

 16%|█▌        | 864/5424 [04:01<21:15,  3.57it/s]


 16%|█▌        | 879/5424 [04:05<21:15,  3.56it/s]

 16%|█▋        | 886/5424 [04:07<20:57,  3.61it/s]


 17%|█▋        | 900/5424 [04:11<20:50,  3.62it/s]

 17%|█▋        | 907/5424 [04:13<21:09,  3.56it/s]

 17%|█▋        | 915/5424 [04:15<21:03,  3.57it/s]


 17%|█▋        | 929/5424 [04:19<20:44,  3.61it/s]

 17%|█▋        | 936/5424 [04:21<20:46,  3.60it/s]


 18%|█▊        | 950/5424 [04:25<20:42,  3.60it/s]

 18%|█▊        | 958/5424 [04:27<20:42,  3.59it/s]

 18%|█▊        | 965/5424 [04:29<20:35,  3.61it/s]


 18%|█▊        | 979/5424 [04:33<20:25,  3.63it/s]

 18%|█▊        | 986/5424 [04:35<20:45,  3.56it/s]


 18%|█▊        | 1001/5424 [04:39<20:43,  3.56it/s]

 19%|█▊        | 1008/5424 [04:41<20:30,  3.59it/s]

 19%|█▊        | 1015/5424 [04:43<20:23,  3.60it/s]


 19%|█▉        | 1029/5424 [04:47<20:55,  3.50it/s]

 19%|█▉        | 1036/5424 [04:49<20:42,  3.53it/s]


 19%|█▉        | 1051/5424 [04:53<20:14,  3.60it/s]

 20%|█▉        | 1058/5424 [04:55<20:10,  3.61it/s]

 20%|█▉        | 1065/5424 [04:57<20:20,  3.57it/s]


 20%|█▉        | 1080/5424 [05:02<20:11,  3.59it/s]

 20%|██        | 1087/5424 [05:04<20:28,  3.53it/s]


 20%|██        | 1101/5424 [05:08<20:36,  3.50it/s]

 20%|██        | 1108/5424 [05:09<19:58,  3.60it/s]

 21%|██        | 1115/5424 [05:11<20:22,  3.53it/s]


 21%|██        | 1129/5424 [05:15<19:57,  3.59it/s]

 21%|██        | 1137/5424 [05:18<19:43,  3.62it/s]


 21%|██        | 1151/5424 [05:22<19:54,  3.58it/s]

 21%|██▏       | 1158/5424 [05:23<19:52,  3.58it/s]

 21%|██▏       | 1165/5424 [05:25<19:43,  3.60it/s]


 22%|██▏       | 1180/5424 [05:30<19:37,  3.60it/s]

 22%|██▏       | 1187/5424 [05:32<20:29,  3.44it/s]


 22%|██▏       | 1201/5424 [05:36<19:36,  3.59it/s]


 22%|██▏       | 1215/5424 [05:39<19:25,  3.61it/s]
{'loss': 0.5213, 'grad_norm': 0.21332478523254395, 'learning_rate': 8.825398554026913e-06, 'rewards/margins': 0.8494318723678589, 'rewards/chosen': -0.6625394225120544, 'rewards/rejected': -1.5119715929031372, 'logps/margins': 23.702234268188477, 'logps/chosen': -19.739822387695312, 'logps/rejected': -43.442054748535156, 'accuracy': 0.800000011920929, 'epoch': 0.67}


 23%|██▎       | 1230/5424 [05:44<19:23,  3.60it/s]

 23%|██▎       | 1237/5424 [05:46<19:15,  3.62it/s]


 23%|██▎       | 1251/5424 [05:49<19:37,  3.54it/s]

 23%|██▎       | 1259/5424 [05:52<19:17,  3.60it/s]

 23%|██▎       | 1266/5424 [05:54<19:56,  3.48it/s]


 24%|██▎       | 1280/5424 [05:58<19:19,  3.57it/s]

 24%|██▎       | 1287/5424 [06:00<19:38,  3.51it/s]


 24%|██▍       | 1301/5424 [06:04<19:32,  3.52it/s]

 24%|██▍       | 1308/5424 [06:06<19:14,  3.56it/s]

 24%|██▍       | 1315/5424 [06:07<19:03,  3.59it/s]


 25%|██▍       | 1330/5424 [06:12<19:10,  3.56it/s]

 25%|██▍       | 1336/5424 [06:13<19:08,  3.56it/s]


 25%|██▍       | 1351/5424 [06:18<18:56,  3.58it/s]
{'loss': 0.4516, 'grad_norm': 0.11835625767707825, 'learning_rate': 8.552031375380327e-06, 'rewards/margins': 1.152583360671997, 'rewards/chosen': -0.47744020819664, 'rewards/rejected': -1.6300233602523804, 'logps/margins': 30.948511123657227, 'logps/chosen': -18.580364227294922, 'logps/rejected': -49.52887725830078, 'accuracy': 0.800000011920929, 'epoch': 0.75}

 25%|██▌       | 1356/5424 [06:19<18:51,  3.59it/s]













 95%|█████████▍| 190/201 [00:25<00:01,  7.50it/s]
{'eval_loss': 0.4690626561641693, 'eval_accuracy': 0.8258706467661692, 'eval_runtime': 50.3685, 'eval_samples_per_second': 3.991, 'eval_steps_per_second': 3.991, 'eval_rewards/margins': 1.0619174242019653, 'eval_rewards/chosen': -0.7246806025505066, 'eval_rewards/rejected': -1.7865979671478271, 'eval_logps/margins': 23.0603084564209, 'eval_logps/chosen': -23.486875534057617, 'eval_logps/rejected': -46.54719161987305, 'epoch': 0.75}


 25%|██▌       | 1370/5424 [07:24<30:49,  2.19it/s]

 25%|██▌       | 1377/5424 [07:26<19:37,  3.44it/s]


 26%|██▌       | 1391/5424 [07:30<18:53,  3.56it/s]

 26%|██▌       | 1399/5424 [07:32<18:19,  3.66it/s]

 26%|██▌       | 1406/5424 [07:34<18:23,  3.64it/s]


 26%|██▌       | 1420/5424 [07:38<18:11,  3.67it/s]

 26%|██▋       | 1428/5424 [07:40<18:09,  3.67it/s]

 26%|██▋       | 1435/5424 [07:42<18:07,  3.67it/s]


 27%|██▋       | 1450/5424 [07:46<18:10,  3.65it/s]

 27%|██▋       | 1457/5424 [07:48<17:56,  3.69it/s]


 27%|██▋       | 1471/5424 [07:52<18:21,  3.59it/s]

 27%|██▋       | 1479/5424 [07:54<17:59,  3.65it/s]

 27%|██▋       | 1486/5424 [07:56<17:59,  3.65it/s]


 28%|██▊       | 1500/5424 [08:00<18:14,  3.58it/s]

 28%|██▊       | 1508/5424 [08:02<17:48,  3.67it/s]

 28%|██▊       | 1515/5424 [08:04<17:40,  3.68it/s]


 28%|██▊       | 1530/5424 [08:08<17:34,  3.69it/s]

 28%|██▊       | 1537/5424 [08:10<17:51,  3.63it/s]


 29%|██▊       | 1552/5424 [08:14<17:49,  3.62it/s]

 29%|██▊       | 1559/5424 [08:16<17:31,  3.68it/s]

 29%|██▉       | 1566/5424 [08:18<17:55,  3.59it/s]


 29%|██▉       | 1581/5424 [08:22<17:38,  3.63it/s]

 29%|██▉       | 1588/5424 [08:24<17:20,  3.69it/s]

 29%|██▉       | 1594/5424 [08:25<17:25,  3.66it/s]


 30%|██▉       | 1608/5424 [08:29<17:38,  3.61it/s]

 30%|██▉       | 1616/5424 [08:31<17:25,  3.64it/s]

 30%|██▉       | 1623/5424 [08:33<17:13,  3.68it/s]


 30%|███       | 1638/5424 [08:37<17:04,  3.70it/s]

 30%|███       | 1645/5424 [08:39<17:18,  3.64it/s]


 31%|███       | 1660/5424 [08:43<16:58,  3.70it/s]

 31%|███       | 1667/5424 [08:45<17:02,  3.67it/s]

 31%|███       | 1675/5424 [08:48<17:08,  3.64it/s]


 31%|███       | 1689/5424 [08:51<16:50,  3.70it/s]

 31%|███▏      | 1697/5424 [08:54<16:55,  3.67it/s]

 31%|███▏      | 1704/5424 [08:55<17:06,  3.63it/s]


 32%|███▏      | 1719/5424 [09:00<16:53,  3.66it/s]

 32%|███▏      | 1726/5424 [09:01<16:47,  3.67it/s]

 32%|███▏      | 1733/5424 [09:03<16:42,  3.68it/s]


 32%|███▏      | 1748/5424 [09:07<16:34,  3.70it/s]

 32%|███▏      | 1755/5424 [09:09<16:33,  3.69it/s]


 33%|███▎      | 1770/5424 [09:14<16:47,  3.63it/s]

 33%|███▎      | 1777/5424 [09:15<16:50,  3.61it/s]

 33%|███▎      | 1785/5424 [09:18<16:31,  3.67it/s]


 33%|███▎      | 1799/5424 [09:22<16:31,  3.65it/s]

 33%|███▎      | 1806/5424 [09:23<16:23,  3.68it/s]

 33%|███▎      | 1814/5424 [09:26<16:23,  3.67it/s]


 34%|███▎      | 1828/5424 [09:29<16:13,  3.70it/s]

 34%|███▍      | 1836/5424 [09:32<16:17,  3.67it/s]

 34%|███▍      | 1843/5424 [09:33<16:11,  3.69it/s]


 34%|███▍      | 1858/5424 [09:38<16:13,  3.66it/s]

 34%|███▍      | 1865/5424 [09:39<16:05,  3.69it/s]


 35%|███▍      | 1880/5424 [09:44<15:57,  3.70it/s]

 35%|███▍      | 1887/5424 [09:45<15:55,  3.70it/s]

 35%|███▍      | 1895/5424 [09:48<15:57,  3.69it/s]


 35%|███▌      | 1909/5424 [09:51<16:23,  3.57it/s]

 35%|███▌      | 1917/5424 [09:54<16:01,  3.65it/s]

 35%|███▌      | 1924/5424 [09:56<15:55,  3.66it/s]


 36%|███▌      | 1938/5424 [09:59<16:00,  3.63it/s]

 36%|███▌      | 1946/5424 [10:02<15:57,  3.63it/s]

 36%|███▌      | 1953/5424 [10:04<15:38,  3.70it/s]


 36%|███▋      | 1968/5424 [10:08<15:55,  3.62it/s]

 36%|███▋      | 1975/5424 [10:10<15:48,  3.64it/s]


 37%|███▋      | 1990/5424 [10:14<15:30,  3.69it/s]

 37%|███▋      | 1997/5424 [10:16<15:29,  3.69it/s]

 37%|███▋      | 2004/5424 [10:18<15:35,  3.66it/s]


 37%|███▋      | 2019/5424 [10:22<15:31,  3.66it/s]

 37%|███▋      | 2026/5424 [10:24<15:37,  3.63it/s]

 38%|███▊      | 2034/5424 [10:26<15:39,  3.61it/s]


 38%|███▊      | 2048/5424 [10:30<15:30,  3.63it/s]

 38%|███▊      | 2056/5424 [10:32<15:40,  3.58it/s]


 38%|███▊      | 2070/5424 [10:36<15:16,  3.66it/s]

 38%|███▊      | 2078/5424 [10:38<15:11,  3.67it/s]

 38%|███▊      | 2085/5424 [10:40<15:17,  3.64it/s]


 39%|███▊      | 2099/5424 [10:44<15:09,  3.66it/s]

 39%|███▉      | 2107/5424 [10:46<14:57,  3.69it/s]

 39%|███▉      | 2114/5424 [10:48<15:10,  3.63it/s]


 39%|███▉      | 2129/5424 [10:52<15:12,  3.61it/s]

 39%|███▉      | 2136/5424 [10:54<15:09,  3.61it/s]

 40%|███▉      | 2143/5424 [10:56<15:08,  3.61it/s]


 40%|███▉      | 2158/5424 [11:00<15:12,  3.58it/s]

 40%|███▉      | 2165/5424 [11:02<14:49,  3.66it/s]


 40%|████      | 2180/5424 [11:06<14:57,  3.62it/s]

 40%|████      | 2187/5424 [11:08<14:53,  3.62it/s]

 40%|████      | 2194/5424 [11:10<14:55,  3.61it/s]


 41%|████      | 2209/5424 [11:14<14:33,  3.68it/s]

 41%|████      | 2216/5424 [11:16<14:30,  3.69it/s]

 41%|████      | 2223/5424 [11:18<14:50,  3.59it/s]


 41%|████▏     | 2238/5424 [11:22<14:30,  3.66it/s]

 41%|████▏     | 2246/5424 [11:24<14:26,  3.67it/s]


 42%|████▏     | 2260/5424 [11:28<14:26,  3.65it/s]

 42%|████▏     | 2267/5424 [11:30<14:30,  3.63it/s]

 42%|████▏     | 2275/5424 [11:32<14:26,  3.64it/s]


 42%|████▏     | 2289/5424 [11:36<14:10,  3.69it/s]

 42%|████▏     | 2297/5424 [11:38<14:08,  3.68it/s]

 42%|████▏     | 2304/5424 [11:40<14:03,  3.70it/s]


 43%|████▎     | 2319/5424 [11:44<13:59,  3.70it/s]

 43%|████▎     | 2326/5424 [11:46<14:15,  3.62it/s]

 43%|████▎     | 2334/5424 [11:48<14:00,  3.68it/s]


 43%|████▎     | 2348/5424 [11:52<14:01,  3.66it/s]

 43%|████▎     | 2356/5424 [11:54<13:50,  3.69it/s]


 44%|████▎     | 2370/5424 [11:58<14:00,  3.63it/s]

 44%|████▍     | 2378/5424 [12:00<13:49,  3.67it/s]

 44%|████▍     | 2385/5424 [12:02<14:00,  3.61it/s]


 44%|████▍     | 2400/5424 [12:06<13:42,  3.68it/s]

 44%|████▍     | 2407/5424 [12:08<13:50,  3.63it/s]

 45%|████▍     | 2414/5424 [12:10<13:36,  3.69it/s]


 45%|████▍     | 2429/5424 [12:14<13:29,  3.70it/s]

 45%|████▍     | 2436/5424 [12:16<13:27,  3.70it/s]

 45%|████▌     | 2444/5424 [12:18<13:32,  3.67it/s]


 45%|████▌     | 2458/5424 [12:22<13:28,  3.67it/s]

 45%|████▌     | 2466/5424 [12:24<13:27,  3.67it/s]


 46%|████▌     | 2480/5424 [12:28<13:17,  3.69it/s]

 46%|████▌     | 2488/5424 [12:30<13:15,  3.69it/s]

 46%|████▌     | 2495/5424 [12:32<13:26,  3.63it/s]


 46%|████▋     | 2510/5424 [12:36<13:17,  3.65it/s]

 46%|████▋     | 2517/5424 [12:38<13:10,  3.68it/s]

 47%|████▋     | 2524/5424 [12:40<13:09,  3.67it/s]


 47%|████▋     | 2539/5424 [12:44<13:21,  3.60it/s]

 47%|████▋     | 2546/5424 [12:46<13:16,  3.61it/s]

 47%|████▋     | 2553/5424 [12:48<13:03,  3.66it/s]


 47%|████▋     | 2568/5424 [12:52<12:52,  3.70it/s]

 47%|████▋     | 2575/5424 [12:54<13:36,  3.49it/s]


 48%|████▊     | 2590/5424 [12:58<12:49,  3.68it/s]

 48%|████▊     | 2597/5424 [13:00<12:58,  3.63it/s]

 48%|████▊     | 2605/5424 [13:02<12:46,  3.68it/s]


 48%|████▊     | 2619/5424 [13:06<13:18,  3.51it/s]

 48%|████▊     | 2626/5424 [13:08<12:47,  3.64it/s]

 49%|████▊     | 2633/5424 [13:10<12:46,  3.64it/s]


 49%|████▉     | 2648/5424 [13:14<12:34,  3.68it/s]

 49%|████▉     | 2656/5424 [13:16<12:31,  3.68it/s]


 49%|████▉     | 2670/5424 [13:20<12:26,  3.69it/s]

 49%|████▉     | 2678/5424 [13:22<12:25,  3.68it/s]

 50%|████▉     | 2685/5424 [13:24<12:20,  3.70it/s]


 50%|████▉     | 2700/5424 [13:28<12:22,  3.67it/s]

 50%|████▉     | 2707/5424 [13:30<12:24,  3.65it/s]
{'loss': 0.5778, 'grad_norm': 0.528202474117279, 'learning_rate': 5.01172904974084e-06, 'rewards/margins': 1.2663497924804688, 'rewards/chosen': -1.3260568380355835, 'rewards/rejected': -2.5924062728881836, 'logps/margins': 23.609275817871094, 'logps/chosen': -31.74087905883789, 'logps/rejected': -55.35015869140625, 'accuracy': 0.699999988079071, 'epoch': 1.5}

 50%|█████     | 2712/5424 [13:31<12:26,  3.63it/s]













 97%|█████████▋| 195/201 [00:26<00:00,  7.49it/s]



 50%|█████     | 2720/5424 [14:16<59:31,  1.32s/it]

 50%|█████     | 2728/5424 [14:18<14:54,  3.02it/s]

 50%|█████     | 2735/5424 [14:20<12:25,  3.61it/s]


 51%|█████     | 2750/5424 [14:24<12:29,  3.57it/s]

 51%|█████     | 2757/5424 [14:26<12:07,  3.67it/s]

 51%|█████     | 2764/5424 [14:28<12:02,  3.68it/s]


 51%|█████     | 2779/5424 [14:32<12:41,  3.47it/s]

 51%|█████▏    | 2786/5424 [14:34<12:24,  3.55it/s]


 52%|█████▏    | 2801/5424 [14:38<11:59,  3.64it/s]

 52%|█████▏    | 2808/5424 [14:40<12:03,  3.62it/s]

 52%|█████▏    | 2815/5424 [14:42<12:02,  3.61it/s]


 52%|█████▏    | 2830/5424 [14:46<12:15,  3.52it/s]

 52%|█████▏    | 2837/5424 [14:48<11:51,  3.63it/s]

 52%|█████▏    | 2844/5424 [14:50<11:54,  3.61it/s]


 53%|█████▎    | 2859/5424 [14:54<11:51,  3.61it/s]

 53%|█████▎    | 2866/5424 [14:56<11:36,  3.67it/s]


 53%|█████▎    | 2881/5424 [15:00<11:43,  3.61it/s]

 53%|█████▎    | 2887/5424 [15:02<11:45,  3.59it/s]

 53%|█████▎    | 2895/5424 [15:04<11:46,  3.58it/s]


 54%|█████▎    | 2910/5424 [15:08<11:22,  3.68it/s]

 54%|█████▍    | 2917/5424 [15:10<11:25,  3.66it/s]

 54%|█████▍    | 2924/5424 [15:12<11:29,  3.63it/s]


 54%|█████▍    | 2939/5424 [15:16<11:15,  3.68it/s]

 54%|█████▍    | 2946/5424 [15:18<11:13,  3.68it/s]


 55%|█████▍    | 2960/5424 [15:22<11:22,  3.61it/s]

 55%|█████▍    | 2968/5424 [15:24<11:11,  3.66it/s]

 55%|█████▍    | 2975/5424 [15:26<11:12,  3.64it/s]


 55%|█████▌    | 2990/5424 [15:30<11:06,  3.65it/s]

 55%|█████▌    | 2997/5424 [15:32<11:12,  3.61it/s]

 55%|█████▌    | 3004/5424 [15:34<10:59,  3.67it/s]


 56%|█████▌    | 3019/5424 [15:38<10:53,  3.68it/s]

 56%|█████▌    | 3026/5424 [15:40<11:09,  3.58it/s]


 56%|█████▌    | 3041/5424 [15:44<10:59,  3.62it/s]

 56%|█████▌    | 3048/5424 [15:46<10:42,  3.70it/s]

 56%|█████▋    | 3055/5424 [15:48<10:59,  3.59it/s]


 57%|█████▋    | 3070/5424 [15:52<10:52,  3.61it/s]

 57%|█████▋    | 3077/5424 [15:54<10:45,  3.64it/s]

 57%|█████▋    | 3084/5424 [15:56<10:45,  3.62it/s]


 57%|█████▋    | 3099/5424 [16:00<10:30,  3.69it/s]

 57%|█████▋    | 3106/5424 [16:02<10:32,  3.67it/s]


 58%|█████▊    | 3121/5424 [16:06<10:26,  3.68it/s]

 58%|█████▊    | 3128/5424 [16:08<10:19,  3.70it/s]

 58%|█████▊    | 3136/5424 [16:10<10:20,  3.69it/s]


 58%|█████▊    | 3150/5424 [16:14<10:26,  3.63it/s]

 58%|█████▊    | 3158/5424 [16:17<10:18,  3.66it/s]

 58%|█████▊    | 3165/5424 [16:18<10:14,  3.67it/s]


 59%|█████▊    | 3180/5424 [16:23<10:09,  3.68it/s]

 59%|█████▉    | 3187/5424 [16:25<10:32,  3.54it/s]

 59%|█████▉    | 3194/5424 [16:26<10:15,  3.62it/s]


 59%|█████▉    | 3208/5424 [16:30<10:08,  3.64it/s]

 59%|█████▉    | 3216/5424 [16:33<09:59,  3.68it/s]


 60%|█████▉    | 3230/5424 [16:36<09:56,  3.68it/s]

 60%|█████▉    | 3238/5424 [16:38<09:49,  3.71it/s]

 60%|█████▉    | 3245/5424 [16:40<09:55,  3.66it/s]


 60%|██████    | 3260/5424 [16:45<09:48,  3.68it/s]

 60%|██████    | 3267/5424 [16:46<09:52,  3.64it/s]

 60%|██████    | 3275/5424 [16:49<09:43,  3.68it/s]


 61%|██████    | 3289/5424 [16:52<09:40,  3.68it/s]

 61%|██████    | 3297/5424 [16:55<09:45,  3.64it/s]


 61%|██████    | 3311/5424 [16:59<09:46,  3.60it/s]

 61%|██████    | 3318/5424 [17:00<09:45,  3.60it/s]

 61%|██████▏   | 3325/5424 [17:02<09:38,  3.63it/s]


 62%|██████▏   | 3340/5424 [17:07<09:31,  3.65it/s]

 62%|██████▏   | 3347/5424 [17:08<09:30,  3.64it/s]

 62%|██████▏   | 3355/5424 [17:11<09:21,  3.68it/s]


 62%|██████▏   | 3369/5424 [17:15<09:25,  3.63it/s]

 62%|██████▏   | 3376/5424 [17:16<09:18,  3.67it/s]


 63%|██████▎   | 3391/5424 [17:21<09:14,  3.67it/s]

 63%|██████▎   | 3398/5424 [17:22<09:12,  3.67it/s]

 63%|██████▎   | 3406/5424 [17:25<09:07,  3.69it/s]


 63%|██████▎   | 3420/5424 [17:28<09:11,  3.63it/s]

 63%|██████▎   | 3428/5424 [17:31<09:10,  3.63it/s]

 63%|██████▎   | 3435/5424 [17:33<09:02,  3.67it/s]


 64%|██████▎   | 3450/5424 [17:37<09:03,  3.63it/s]

 64%|██████▎   | 3457/5424 [17:39<09:03,  3.62it/s]

 64%|██████▍   | 3464/5424 [17:41<09:12,  3.55it/s]


 64%|██████▍   | 3479/5424 [17:45<08:56,  3.62it/s]

 64%|██████▍   | 3486/5424 [17:47<08:55,  3.62it/s]


 65%|██████▍   | 3501/5424 [17:51<08:50,  3.62it/s]

 65%|██████▍   | 3508/5424 [17:53<08:50,  3.61it/s]

 65%|██████▍   | 3515/5424 [17:55<08:45,  3.63it/s]


 65%|██████▌   | 3530/5424 [17:59<08:39,  3.64it/s]

 65%|██████▌   | 3537/5424 [18:01<08:33,  3.68it/s]

 65%|██████▌   | 3544/5424 [18:03<08:34,  3.66it/s]


 66%|██████▌   | 3559/5424 [18:07<08:29,  3.66it/s]

 66%|██████▌   | 3566/5424 [18:09<08:35,  3.60it/s]


 66%|██████▌   | 3581/5424 [18:13<08:22,  3.67it/s]

 66%|██████▌   | 3588/5424 [18:15<08:20,  3.67it/s]

 66%|██████▋   | 3595/5424 [18:17<08:18,  3.67it/s]


 67%|██████▋   | 3610/5424 [18:21<08:31,  3.55it/s]

 67%|██████▋   | 3617/5424 [18:23<08:17,  3.63it/s]

 67%|██████▋   | 3624/5424 [18:25<08:13,  3.65it/s]


 67%|██████▋   | 3639/5424 [18:29<08:08,  3.65it/s]

 67%|██████▋   | 3646/5424 [18:31<08:11,  3.62it/s]


 67%|██████▋   | 3661/5424 [18:35<08:04,  3.64it/s]

 68%|██████▊   | 3668/5424 [18:37<08:00,  3.65it/s]

 68%|██████▊   | 3675/5424 [18:39<08:04,  3.61it/s]


 68%|██████▊   | 3690/5424 [18:43<07:58,  3.63it/s]

 68%|██████▊   | 3697/5424 [18:45<07:49,  3.68it/s]

 68%|██████▊   | 3705/5424 [18:47<07:48,  3.67it/s]


 69%|██████▊   | 3719/5424 [18:51<07:49,  3.63it/s]

 69%|██████▊   | 3726/5424 [18:53<07:50,  3.61it/s]


 69%|██████▉   | 3741/5424 [18:57<07:50,  3.58it/s]

 69%|██████▉   | 3748/5424 [18:59<07:47,  3.59it/s]

 69%|██████▉   | 3755/5424 [19:01<07:38,  3.64it/s]


 70%|██████▉   | 3770/5424 [19:05<07:41,  3.58it/s]

 70%|██████▉   | 3776/5424 [19:07<10:02,  2.73it/s]


 70%|██████▉   | 3791/5424 [19:11<07:31,  3.62it/s]

 70%|███████   | 3798/5424 [19:13<07:27,  3.63it/s]

 70%|███████   | 3805/5424 [19:15<07:18,  3.69it/s]


 70%|███████   | 3820/5424 [19:19<07:17,  3.67it/s]

 71%|███████   | 3827/5424 [19:21<07:24,  3.59it/s]

 71%|███████   | 3834/5424 [19:23<07:22,  3.59it/s]


 71%|███████   | 3849/5424 [19:27<07:06,  3.69it/s]

 71%|███████   | 3856/5424 [19:29<07:09,  3.65it/s]


 71%|███████▏  | 3871/5424 [19:33<07:12,  3.59it/s]

 71%|███████▏  | 3878/5424 [19:35<07:01,  3.67it/s]

 72%|███████▏  | 3886/5424 [19:37<07:05,  3.61it/s]


 72%|███████▏  | 3898/5424 [19:40<06:58,  3.64it/s]

 72%|███████▏  | 3906/5424 [19:42<06:54,  3.66it/s]

 72%|███████▏  | 3913/5424 [19:44<06:50,  3.68it/s]


 72%|███████▏  | 3928/5424 [19:48<06:53,  3.62it/s]

 73%|███████▎  | 3935/5424 [19:50<06:57,  3.57it/s]


 73%|███████▎  | 3949/5424 [19:54<06:40,  3.69it/s]

 73%|███████▎  | 3957/5424 [19:56<06:42,  3.64it/s]

 73%|███████▎  | 3964/5424 [19:58<06:40,  3.64it/s]


 73%|███████▎  | 3978/5424 [20:02<06:34,  3.66it/s]

 73%|███████▎  | 3986/5424 [20:04<06:32,  3.67it/s]

 74%|███████▎  | 3993/5424 [20:06<06:34,  3.63it/s]


 74%|███████▍  | 4008/5424 [20:10<06:30,  3.63it/s]

 74%|███████▍  | 4015/5424 [20:12<06:24,  3.66it/s]


 74%|███████▍  | 4030/5424 [20:17<06:25,  3.62it/s]

 74%|███████▍  | 4037/5424 [20:18<06:17,  3.67it/s]

 75%|███████▍  | 4044/5424 [20:20<06:19,  3.64it/s]


 75%|███████▍  | 4059/5424 [20:24<06:10,  3.69it/s]

 75%|███████▍  | 4066/5424 [20:26<06:11,  3.65it/s]

 75%|███████▌  | 4068/5424 [20:27<06:09,  3.67it/s]












 94%|█████████▍| 189/201 [00:25<00:01,  7.52it/s]

{'eval_loss': 0.45877546072006226, 'eval_accuracy': 0.8159203980099502, 'eval_runtime': 51.2622, 'eval_samples_per_second': 3.921, 'eval_steps_per_second': 3.921, 'eval_rewards/margins': 1.6223833560943604, 'eval_rewards/chosen': -1.0194817781448364, 'eval_rewards/rejected': -2.6418652534484863, 'eval_logps/margins': 28.664968490600586, 'eval_logps/chosen': -26.434886932373047, 'eval_logps/rejected': -55.099857330322266, 'epoch': 2.25}

 75%|███████▌  | 4073/5424 [21:29<1:43:49,  4.61s/it]


 75%|███████▌  | 4088/5424 [21:33<06:37,  3.36it/s]

 75%|███████▌  | 4095/5424 [21:35<06:06,  3.63it/s]


 76%|███████▌  | 4110/5424 [21:39<06:02,  3.63it/s]

 76%|███████▌  | 4117/5424 [21:41<05:57,  3.66it/s]

 76%|███████▌  | 4124/5424 [21:43<05:51,  3.69it/s]


 76%|███████▋  | 4139/5424 [21:47<05:55,  3.62it/s]

 76%|███████▋  | 4146/5424 [21:49<05:49,  3.66it/s]

 77%|███████▋  | 4154/5424 [21:51<05:43,  3.69it/s]


 77%|███████▋  | 4168/5424 [21:55<05:46,  3.63it/s]

 77%|███████▋  | 4175/5424 [21:57<05:44,  3.62it/s]

 77%|███████▋  | 4183/5424 [21:59<05:40,  3.64it/s]


 77%|███████▋  | 4197/5424 [22:03<05:38,  3.62it/s]

 78%|███████▊  | 4205/5424 [22:05<05:34,  3.65it/s]


 78%|███████▊  | 4219/5424 [22:09<05:30,  3.65it/s]

 78%|███████▊  | 4226/5424 [22:11<05:36,  3.56it/s]

 78%|███████▊  | 4234/5424 [22:13<05:24,  3.67it/s]


 78%|███████▊  | 4249/5424 [22:17<05:20,  3.66it/s]

 78%|███████▊  | 4256/5424 [22:19<05:20,  3.64it/s]

 79%|███████▊  | 4263/5424 [22:21<05:19,  3.64it/s]


 79%|███████▉  | 4278/5424 [22:25<05:14,  3.64it/s]

 79%|███████▉  | 4285/5424 [22:27<05:10,  3.67it/s]


 79%|███████▉  | 4300/5424 [22:31<05:07,  3.65it/s]

 79%|███████▉  | 4307/5424 [22:33<05:07,  3.63it/s]

 80%|███████▉  | 4314/5424 [22:35<05:04,  3.65it/s]


 80%|███████▉  | 4329/5424 [22:39<05:01,  3.63it/s]

 80%|███████▉  | 4336/5424 [22:41<04:55,  3.68it/s]

 80%|████████  | 4343/5424 [22:43<05:04,  3.55it/s]


 80%|████████  | 4358/5424 [22:47<04:55,  3.61it/s]

 80%|████████  | 4365/5424 [22:49<04:50,  3.64it/s]


 81%|████████  | 4380/5424 [22:53<04:43,  3.68it/s]

 81%|████████  | 4387/5424 [22:55<04:45,  3.63it/s]

 81%|████████  | 4395/5424 [22:57<04:41,  3.65it/s]


 81%|████████▏ | 4409/5424 [23:01<04:36,  3.68it/s]

 81%|████████▏ | 4416/5424 [23:03<04:36,  3.64it/s]

 82%|████████▏ | 4424/5424 [23:05<04:36,  3.62it/s]


 82%|████████▏ | 4438/5424 [23:09<04:27,  3.69it/s]

 82%|████████▏ | 4446/5424 [23:11<04:27,  3.66it/s]

 82%|████████▏ | 4453/5424 [23:13<04:24,  3.67it/s]


 82%|████████▏ | 4468/5424 [23:17<04:21,  3.65it/s]

 83%|████████▎ | 4475/5424 [23:19<04:18,  3.68it/s]


 83%|████████▎ | 4490/5424 [23:23<04:13,  3.69it/s]

 83%|████████▎ | 4497/5424 [23:25<04:18,  3.59it/s]

 83%|████████▎ | 4504/5424 [23:27<04:13,  3.63it/s]


 83%|████████▎ | 4519/5424 [23:31<04:13,  3.57it/s]

 83%|████████▎ | 4526/5424 [23:33<04:04,  3.68it/s]

 84%|████████▎ | 4533/5424 [23:35<04:04,  3.64it/s]


 84%|████████▍ | 4548/5424 [23:39<03:59,  3.65it/s]

 84%|████████▍ | 4555/5424 [23:41<03:56,  3.68it/s]


 84%|████████▍ | 4570/5424 [23:45<03:51,  3.69it/s]

 84%|████████▍ | 4577/5424 [23:47<03:50,  3.67it/s]

 85%|████████▍ | 4585/5424 [23:49<03:47,  3.69it/s]


 85%|████████▍ | 4599/5424 [23:53<03:46,  3.64it/s]

 85%|████████▍ | 4607/5424 [23:55<03:41,  3.68it/s]

 85%|████████▌ | 4614/5424 [23:57<03:40,  3.67it/s]


 85%|████████▌ | 4629/5424 [24:01<03:40,  3.61it/s]

 85%|████████▌ | 4636/5424 [24:03<03:36,  3.64it/s]

 86%|████████▌ | 4643/5424 [24:05<03:34,  3.63it/s]


 86%|████████▌ | 4658/5424 [24:09<03:27,  3.70it/s]

 86%|████████▌ | 4665/5424 [24:11<03:30,  3.61it/s]


 86%|████████▋ | 4680/5424 [24:15<03:23,  3.66it/s]

 86%|████████▋ | 4687/5424 [24:17<03:26,  3.56it/s]

 87%|████████▋ | 4694/5424 [24:19<03:19,  3.66it/s]


 87%|████████▋ | 4709/5424 [24:23<03:15,  3.65it/s]

 87%|████████▋ | 4716/5424 [24:25<03:13,  3.67it/s]

 87%|████████▋ | 4723/5424 [24:27<03:15,  3.59it/s]


 87%|████████▋ | 4738/5424 [24:31<03:08,  3.64it/s]

 87%|████████▋ | 4745/5424 [24:33<03:08,  3.60it/s]


 88%|████████▊ | 4760/5424 [24:37<03:03,  3.61it/s]

 88%|████████▊ | 4767/5424 [24:39<03:01,  3.62it/s]

 88%|████████▊ | 4774/5424 [24:41<02:58,  3.65it/s]


 88%|████████▊ | 4789/5424 [24:45<02:51,  3.70it/s]

 88%|████████▊ | 4796/5424 [24:47<02:50,  3.68it/s]

 89%|████████▊ | 4804/5424 [24:49<02:49,  3.65it/s]


 89%|████████▉ | 4818/5424 [24:53<02:46,  3.64it/s]

 89%|████████▉ | 4826/5424 [24:55<02:43,  3.66it/s]


 89%|████████▉ | 4840/5424 [24:59<02:43,  3.57it/s]

 89%|████████▉ | 4847/5424 [25:01<02:38,  3.65it/s]

 90%|████████▉ | 4855/5424 [25:03<02:38,  3.59it/s]


 90%|████████▉ | 4869/5424 [25:07<02:31,  3.66it/s]

 90%|████████▉ | 4876/5424 [25:09<02:34,  3.56it/s]

 90%|█████████ | 4884/5424 [25:11<02:26,  3.68it/s]


 90%|█████████ | 4898/5424 [25:15<02:22,  3.68it/s]

 90%|█████████ | 4906/5424 [25:17<02:20,  3.68it/s]

 91%|█████████ | 4913/5424 [25:19<02:19,  3.66it/s]


 91%|█████████ | 4928/5424 [25:23<02:17,  3.62it/s]

 91%|█████████ | 4935/5424 [25:25<02:16,  3.59it/s]


 91%|█████████▏| 4950/5424 [25:29<02:08,  3.68it/s]

 91%|█████████▏| 4957/5424 [25:31<02:06,  3.68it/s]

 92%|█████████▏| 4964/5424 [25:33<02:05,  3.66it/s]


 92%|█████████▏| 4979/5424 [25:37<02:02,  3.63it/s]

 92%|█████████▏| 4986/5424 [25:39<01:58,  3.68it/s]

 92%|█████████▏| 4994/5424 [25:41<01:57,  3.66it/s]


 92%|█████████▏| 5008/5424 [25:45<01:52,  3.68it/s]

 92%|█████████▏| 5016/5424 [25:47<01:51,  3.67it/s]


 93%|█████████▎| 5030/5424 [25:51<01:46,  3.68it/s]

 93%|█████████▎| 5038/5424 [25:53<01:44,  3.68it/s]

 93%|█████████▎| 5045/5424 [25:55<01:44,  3.64it/s]


 93%|█████████▎| 5060/5424 [25:59<01:39,  3.66it/s]

 93%|█████████▎| 5067/5424 [26:01<01:37,  3.66it/s]

 94%|█████████▎| 5074/5424 [26:03<01:36,  3.62it/s]


 94%|█████████▍| 5089/5424 [26:07<01:32,  3.62it/s]

 94%|█████████▍| 5096/5424 [26:09<01:30,  3.60it/s]

 94%|█████████▍| 5103/5424 [26:11<01:27,  3.67it/s]


 94%|█████████▍| 5118/5424 [26:15<01:24,  3.64it/s]

 94%|█████████▍| 5125/5424 [26:17<01:21,  3.68it/s]


 95%|█████████▍| 5140/5424 [26:21<01:17,  3.65it/s]

 95%|█████████▍| 5147/5424 [26:23<01:17,  3.60it/s]

 95%|█████████▌| 5154/5424 [26:25<01:13,  3.65it/s]


 95%|█████████▌| 5169/5424 [26:29<01:10,  3.63it/s]

 95%|█████████▌| 5176/5424 [26:31<01:07,  3.68it/s]

 96%|█████████▌| 5183/5424 [26:33<01:06,  3.61it/s]


 96%|█████████▌| 5198/5424 [26:37<01:01,  3.69it/s]

 96%|█████████▌| 5206/5424 [26:39<00:59,  3.69it/s]


 96%|█████████▌| 5220/5424 [26:43<00:55,  3.69it/s]

 96%|█████████▋| 5228/5424 [26:45<00:52,  3.71it/s]

 96%|█████████▋| 5234/5424 [26:47<00:52,  3.59it/s]


 97%|█████████▋| 5250/5424 [26:51<00:47,  3.69it/s]

 97%|█████████▋| 5257/5424 [26:53<00:46,  3.57it/s]

 97%|█████████▋| 5264/5424 [26:55<00:44,  3.63it/s]


 97%|█████████▋| 5278/5424 [26:59<00:40,  3.60it/s]

 97%|█████████▋| 5286/5424 [27:01<00:37,  3.64it/s]


 98%|█████████▊| 5300/5424 [27:05<00:34,  3.60it/s]

 98%|█████████▊| 5308/5424 [27:07<00:31,  3.67it/s]


 98%|█████████▊| 5322/5424 [27:11<00:27,  3.68it/s]

 98%|█████████▊| 5330/5424 [27:13<00:25,  3.62it/s]

 98%|█████████▊| 5337/5424 [27:15<00:23,  3.67it/s]

 99%|█████████▊| 5344/5424 [27:17<00:21,  3.66it/s]


 99%|█████████▉| 5359/5424 [27:21<00:18,  3.57it/s]

 99%|█████████▉| 5366/5424 [27:23<00:16,  3.60it/s]


 99%|█████████▉| 5381/5424 [27:28<00:11,  3.67it/s]

 99%|█████████▉| 5388/5424 [27:29<00:09,  3.69it/s]

 99%|█████████▉| 5395/5424 [27:31<00:07,  3.66it/s]


100%|█████████▉| 5410/5424 [27:35<00:03,  3.64it/s]

100%|█████████▉| 5417/5424 [27:37<00:01,  3.66it/s]

100%|██████████| 5424/5424 [27:39<00:00,  3.65it/s]
generating response...













 96%|█████████▌| 193/201 [00:26<00:01,  7.51it/s]


100%|██████████| 5424/5424 [28:42<00:00,  3.15it/s]
{'train_runtime': 1722.1116, 'train_samples_per_second': 3.15, 'train_steps_per_second': 3.15, 'train_loss': 0.44283667162807994, 'epoch': 3.0}
loading model...
{}
{'output_dir': ('./output/dev/dpo',), 'overwrite_output_dir': (True,), 'seed': (42,), 'per_device_train_batch_size': (1,), 'per_device_eval_batch_size': (1,), 'gradient_accumulation_steps': (1,), 'learning_rate': (0.0001,), 'lr_scheduler_type': ('cosine',), 'warmup_steps': (0.1,), 'weight_decay': (0.05,), 'fp16': (True,), 'remove_unused_columns': (False,), 'run_name': ('dev_dpo',), 'report_to': ('wandb',), 'num_train_epochs': (3,), 'logging_steps': (10,), 'save_steps': (0.25,), 'eval_steps': (0.25,), 'eval_delay': (0.25,), 'evaluation_strategy': ('steps',), 'save_total_limit': (3,), 'load_best_model_at_end': (True,)}
{'output_dir': ('./output/dev/dpo',), 'overwrite_output_dir': (True,), 'seed': (42,), 'per_device_train_batch_size': (1,), 'per_device_eval_batch_size': (1,), 'gradient_accumulation_steps': (1,), 'learning_rate': (0.0001,), 'lr_scheduler_type': ('cosine',), 'warmup_steps': (0.1,), 'weight_decay': (0.05,), 'fp16': (True,), 'remove_unused_columns': (False,), 'run_name': ('dev_dpo',), 'report_to': ('wandb',), 'num_train_epochs': (3,), 'logging_steps': (10,), 'save_steps': (0.25,), 'eval_steps': (0.25,), 'eval_delay': (0.25,), 'evaluation_strategy': ('steps',), 'save_total_limit': (3,), 'load_best_model_at_end': (True,)}
Downloading shards: 100%|██████████| 6/6 [00:00<00:00, 896.92it/s]
Loading checkpoint shards:   0%|          | 0/6 [00:00<?, ?it/s]


Loading checkpoint shards:  33%|███▎      | 2/6 [00:03<00:07,  1.91s/it]
UsageError: Line magic function `%scripts/modpo/beavertails/modpo.py` not found.
loading model...
Downloading shards: 100%|██████████| 6/6 [00:00<00:00, 905.83it/s]


Loading checkpoint shards: 100%|██████████| 6/6 [00:05<00:00,  1.15it/s]
LlamaForCausalLM(
  (model): LlamaModel(
    (embed_tokens): Embedding(32000, 5120, padding_idx=0)
    (layers): ModuleList(
      (0-39): 40 x LlamaDecoderLayer(
        (self_attn): LlamaSdpaAttention(
          (q_proj): Linear(in_features=5120, out_features=5120, bias=False)
          (k_proj): Linear(in_features=5120, out_features=5120, bias=False)
          (v_proj): Linear(in_features=5120, out_features=5120, bias=False)
          (o_proj): Linear(in_features=5120, out_features=5120, bias=False)
          (rotary_emb): LlamaRotaryEmbedding()
        )
        (mlp): LlamaMLP(
          (gate_proj): Linear(in_features=5120, out_features=13824, bias=False)
          (up_proj): Linear(in_features=5120, out_features=13824, bias=False)
          (down_proj): Linear(in_features=13824, out_features=5120, bias=False)
          (act_fn): SiLU()
        )
        (input_layernorm): LlamaRMSNorm()
        (post_attention_layernorm): LlamaRMSNorm()
      )
    )
    (norm): LlamaRMSNorm()
  )
  (lm_head): Linear(in_features=5120, out_features=32000, bias=False)
)
LoraConfig(peft_type=<PeftType.LORA: 'LORA'>, auto_mapping=None, base_model_name_or_path=None, revision=None, task_type='CAUSAL_LM', inference_mode=False, r=64, target_modules=['q_proj', 'k_proj', 'v_proj', 'o_proj'], lora_alpha=1, lora_dropout=0.0, fan_in_fan_out=False, bias='none', modules_to_save=None, init_lora_weights=True, layers_to_transform=None, layers_pattern=None)
Map (num_proc=4): 100%|██████████| 1808/1808 [00:00<00:00, 8456.21 examples/s]
mapping dataset to standard format...
Map (num_proc=4): 100%|██████████| 201/201 [00:00<00:00, 1232.56 examples/s]
Map (num_proc=4): 100%|██████████| 1808/1808 [00:00<00:00, 3111.17 examples/s]
Filter: 100%|██████████| 1808/1808 [00:00<00:00, 3211.90 examples/s]
mapping dataset to standard format...
start training...
dataset preprocessing...
Map (num_proc=4): 100%|██████████| 201/201 [00:00<00:00, 615.01 examples/s]
Filter: 100%|██████████| 201/201 [00:00<00:00, 3105.03 examples/s]
train_dataset_retain: 1.0
eval_dataset_retain: 1.0
trainable params: 104,857,600 || all params: 13,330,437,120 || trainable%: 0.7866028627274302
Downloading shards: 100%|██████████| 6/6 [00:00<00:00, 970.08it/s]
Loading checkpoint shards:  17%|█▋        | 1/6 [00:00<00:04,  1.08it/s]



Loading checkpoint shards: 100%|██████████| 6/6 [00:05<00:00,  1.07it/s]
LlamaForCausalLM(
  (model): LlamaModel(
    (embed_tokens): Embedding(32000, 5120, padding_idx=0)
    (layers): ModuleList(
      (0-39): 40 x LlamaDecoderLayer(
        (self_attn): LlamaSdpaAttention(
          (q_proj): Linear(in_features=5120, out_features=5120, bias=False)
          (k_proj): Linear(in_features=5120, out_features=5120, bias=False)
          (v_proj): Linear(in_features=5120, out_features=5120, bias=False)
          (o_proj): Linear(in_features=5120, out_features=5120, bias=False)
          (rotary_emb): LlamaRotaryEmbedding()
        )
        (mlp): LlamaMLP(
          (gate_proj): Linear(in_features=5120, out_features=13824, bias=False)
          (up_proj): Linear(in_features=5120, out_features=13824, bias=False)
          (down_proj): Linear(in_features=13824, out_features=5120, bias=False)
          (act_fn): SiLU()
        )
        (input_layernorm): LlamaRMSNorm()
        (post_attention_layernorm): LlamaRMSNorm()
      )
    )
    (norm): LlamaRMSNorm()
  )
  (lm_head): Linear(in_features=5120, out_features=32000, bias=False)
)
LoraConfig(peft_type=<PeftType.LORA: 'LORA'>, auto_mapping=None, base_model_name_or_path=None, revision=None, task_type='CAUSAL_LM', inference_mode=False, r=64, target_modules=['q_proj', 'k_proj', 'v_proj', 'o_proj'], lora_alpha=1, lora_dropout=0.0, fan_in_fan_out=False, bias='none', modules_to_save=None, init_lora_weights=True, layers_to_transform=None, layers_pattern=None)
Map (num_proc=4): 100%|██████████| 1808/1808 [00:00<00:00, 7860.77 examples/s]
mapping dataset to standard format...
Map (num_proc=4): 100%|██████████| 201/201 [00:00<00:00, 1175.71 examples/s]
Map (num_proc=4): 100%|██████████| 1808/1808 [00:00<00:00, 3065.59 examples/s]
Filter:  55%|█████▌    | 1000/1808 [00:00<00:00, 3193.09 examples/s]
mapping dataset to standard format...
start training...
Filter: 100%|██████████| 1808/1808 [00:00<00:00, 3205.58 examples/s]
Map (num_proc=4): 100%|██████████| 201/201 [00:00<00:00, 597.20 examples/s]
Filter: 100%|██████████| 201/201 [00:00<00:00, 3124.08 examples/s]
  0%|          | 0/5424 [00:00<?, ?it/s]You're using a LlamaTokenizerFast tokenizer. Please note that with a fast tokenizer, using the `__call__` method is faster than using a method to encode the text followed by a call to the `pad` method to get a padded encoding.
train_dataset_retain: 1.0
eval_dataset_retain: 1.0
trainable params: 104,857,600 || all params: 13,330,437,120 || trainable%: 0.7866028627274302
